# DTC 内容电商系统 - 功能文档

> 最后更新：2025-12-24
> 当前进度：步骤 1.1 + 1.2 + 2.x + 3.1~3.5 + 4.1~4.6 + 5.1(部分) + 6.1 已完成
> **架构模式：独立域名多品牌（Multi-tenant）**

## 自动化图例

| 图标 | 含义 | 说明 |
|------|------|------|
| 🤖 自动 | 代码自动执行 | 无需人工干预，系统自动完成 |
| 🧠 AI | AI 辅助生成 | AI 生成内容，人工审核/确认 |
| ⚙️ 配置 | 需要配置 | 人工配置规则，系统按规则执行 |
| - | 手动操作 | 需要人工完成 |

---

## 项目概述

这是一个 **DTC（Direct-to-Consumer）内容电商独立站**系统，采用现代技术栈构建，支持：

- 🛒 **电商功能**：产品展示、购物车、在线支付
- 🤖 **AI 客服**：基于 RAG 的智能问答
- 📝 **内容生成**：AI 生成视频脚本、产品文案
- 📊 **数据分析**：销售统计、利润分析

### 多品牌架构（独立域名模式）

```
┌─────────────────────────────────────────────────────────────┐
│                    Cloudflare Workers (API)                 │
│                    Cloudflare Pages (前端)                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   techgear.com ──────┐                                      │
│                      │      ┌──────────────────────┐        │
│   beautyglow.com ────┼─────▶│   Supabase 数据库    │        │
│                      │      │   (数据按 brand_id   │        │
│   fitnesspro.com ────┘      │    隔离)             │        │
│                             └──────────────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

**工作原理：**
1. 每个品牌绑定独立域名（如 `techgear.com`、`beautyglow.com`）
2. 所有域名指向同一套 Cloudflare Workers/Pages
3. 系统根据访问域名自动识别品牌，查询对应数据
4. 客户看到的是完全独立的网站，互不知道其他品牌存在

**广告投放示例：**
| 品牌 | 域名 | 广告落地页 |
|------|------|------------|
| TechGear | techgear.com | `https://techgear.com/products/wireless-earbuds` |
| BeautyGlow | beautyglow.com | `https://beautyglow.com/products/vitamin-c-serum` |

### 技术栈

| 层级 | 技术 | 说明 |
|------|------|------|
| 前端 | Astro 5.x | 静态生成，SEO 友好 |
| 样式 | TailwindCSS 4.x | 原子化 CSS |
| 后端 | Cloudflare Workers | 边缘计算，全球部署 |
| 数据库 | Supabase (PostgreSQL) | 托管数据库 + 实时功能 |
| 支付 | Stripe | 信用卡、Apple Pay、Google Pay |
| AI | DeepSeek | 对话 + 向量检索 |
| 邮件 | Resend | 订单通知邮件 |

---

## 功能模块清单


### 第一阶段：项目初始化 ✅ 已完成

#### 1.1 基础架构 ✅

| 功能点 | 状态 | 文件位置 |
|--------|------|----------|
| Astro 前端项目结构 | ✅ | `frontend/` |
| Cloudflare Worker 后端结构 | ✅ | `worker/` |
| TailwindCSS 配置 | ✅ | `frontend/tailwind.config.mjs` |
| TypeScript 配置 | ✅ | `frontend/tsconfig.json`, `worker/tsconfig.json` |
| Wrangler 配置 | ✅ | `worker/wrangler.toml` |
| 环境变量模板 | ✅ | `frontend/.env.example` |
| 基础布局组件 | ✅ | `frontend/src/layouts/Layout.astro` |
| API 客户端封装 | ✅ | `frontend/src/lib/api.ts` |
| 购物车状态管理 | ✅ | `frontend/src/lib/cart.ts` |
| Supabase 客户端 | ✅ | `frontend/src/lib/supabase.ts` |
| 数据库类型定义 | ✅ | `frontend/src/lib/database.types.ts` |

#### 1.2 数据库模型 ✅

| 数据表 | 状态 | 用途 |
|--------|------|------|
| `brands` | ✅ | **品牌/站点信息（多租户核心表，含 domain 字段）** |
| `products` | ✅ | 产品信息（名称、价格、图片、SEO 等） |
| `categories` | ✅ | 产品分类（支持层级） |
| `orders` | ✅ | 订单记录（状态、支付、物流） |
| `customers` | ✅ | 客户信息（统计购买历史） |
| `conversations` | ✅ | AI 对话历史 |
| `knowledge_base` | ✅ | RAG 知识库 |
| `settings` | ✅ | 系统设置（AI 开关、店铺信息等） |
| `content_library` | ✅ | AI 生成的内容（脚本、文案） |

**多品牌数据隔离：**
- 所有表都通过 `brand_id` 关联到品牌
- `brands` 表的 `domain` 字段存储独立域名
- 系统根据请求域名查询 `brands.domain` 获取 `brand_id`
- 每个品牌有独立的：产品、分类、订单、客户、设置、知识库

**数据库脚本位置：**
- 建表语句：`docs/database/001_initial_schema.sql`
- RLS 安全策略：`docs/database/002_rls_policies.sql`
- 测试数据：`docs/database/003_sample_data.sql`

---

### 第二阶段：前端页面 + 基础 SEO ✅ 已完成（除明确标注未实现项）

#### 2.1 基础 SEO + GEO（内置于页面开发）

> SEO = 搜索引擎优化（Google 排名）
> GEO = 生成式引擎优化（AI 搜索引用，如 ChatGPT、Perplexity）

**基础 SEO：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| `<title>` 动态标题 | ✅ | 🤖 自动 | 已内置于 Layout.astro，根据页面数据自动生成 |
| `<meta description>` | ✅ | 🤖 自动 | 已内置于 Layout.astro，根据页面数据自动生成 |
| Open Graph 标签 | ✅ | 🤖 自动 | og:title/description/image 已内置，自动生成 |
| Twitter Card | ✅ | 🤖 自动 | summary_large_image 已内置，自动生成 |
| `<link rel="canonical">` | ✅ | 🤖 自动 | 防止重复内容，代码自动生成 |
| 列表筛选/排序/分页 URL 规范 | ✅ | 🤖 自动 | 定义 `/products` 筛选/排序/分页 URL 策略，避免重复内容与抓取预算浪费（与 canonical/robots/noindex 规则联动） |
| URL 参数索引策略 | ✅ | ⚙️ 配置 | 配置是否收录带参数 URL（如 `?sort=`、`?page=`、`?utm_*`），并与 canonical/noindex 规则一致 |
| Product Schema | ✅ | 🤖 自动 | 产品页结构化数据，根据产品数据自动生成 JSON-LD |
| BreadcrumbList Schema | ✅ | 🤖 自动 | 面包屑结构化数据，根据页面路径自动生成 |
| Organization Schema | ✅ | 🤖 自动 | 品牌信息结构化数据，根据品牌设置自动生成 |
| FAQ Schema | ✅ | 🤖 自动 | FAQ 页结构化数据，根据 FAQ 内容自动生成 |
| sitemap.xml 动态生成 | ✅ | 🤖 自动 | 产品/分类/博客变更时自动更新 |
| robots.txt | ✅ | ⚙️ 配置 | 爬虫控制文件（含 AI 爬虫规则），后台可配置 |
| 多语言 lang 属性 | ⬜ | 🤖 自动 | 根据品牌/用户语言设置自动切换 |
| hreflang 标签 | ⬜ | 🤖 自动 | 国际化 SEO，多语言版本自动关联 |

**基础 GEO（AI 搜索友好）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| AI 爬虫 robots.txt | ✅ | ⚙️ 配置 | 允许 GPTBot/ClaudeBot/PerplexityBot 抓取 |
| 发布日期组件 | ✅ | 🤖 自动 | 博客/内容页自动显示发布日期和更新日期 |
| 作者信息组件 | ✅ | 🤖 自动 | 文章自动关联作者，显示头像、姓名、简介链接 |
| 摘要/TL;DR 区域 | 🔶 | 🧠 AI | 已提供摘要组件；当前使用内容字段，不含 AI 自动生成 |
| 问答格式组件 | ✅ | 🤖 自动 | FAQ 使用清晰的 Q&A 结构，自动渲染 |
| 定义式段落 | 🔶 | 🧠 AI | 已提供定义式段落组件；当前为内容渲染，不含 AI 自动生成 |
| 结构化列表 | ✅ | 🤖 自动 | 产品特性、规格自动渲染为列表/表格 |

#### 2.2 首页和布局组件 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 响应式 Header | ✅ | |
| 移动端汉堡菜单 | ✅ | |
| Footer | ✅ | |
| Hero 区域 | ✅ | 大图/视频背景 + CTA |
| 热销产品轮播 | ✅ | |
| 分类展示网格 | ✅ | |
| 社会证明区域 | ✅ | 评价/媒体报道 |
| Email 订阅表单 | ✅ | |
| ProductCard 组件 | ✅ | |
| CategoryCard 组件 | ✅ | |

#### 2.3 产品页面 ✅

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 产品列表页 `/products` | ✅ | - | |
| 左侧筛选栏 | ✅ | 🤖 自动 | 分类、价格、排序，根据数据自动生成筛选项 |
| 产品网格 | ✅ | - | 响应式布局 |
| 分页/无限滚动 | ✅ | 🤖 自动 | 自动计算分页 |
| 产品详情页 `/products/[slug]` | ✅ | - | |
| 图片画廊 | ✅ | - | 主图 + 缩略图 |
| 数量选择器 | ✅ | - | |
| 加入购物车 | ✅ | - | |
| 产品 Tab（描述/规格/发货） | ✅ | 🤖 自动 | 规格自动渲染为结构化列表/表格 |
| 相关产品推荐 | ✅ | 🤖 自动 | 算法自动匹配同分类/标签产品 |
| 分类页面 `/category/[slug]` | ✅ | - | |

#### 2.4 购物车和结算 ✅（Stripe 未实现）

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 迷你购物车（侧边栏） | ✅ | |
| 购物车页面 `/cart` | ✅ | |
| 数量调整/删除 | ✅ | |
| 优惠码输入 | 🔶 | UI 占位，后端优惠券校验待第三阶段 |
| 结算页面 `/checkout` | ✅ | |
| 步骤指示器 | ✅ | 信息 → 支付 → 确认 |
| 收货地址表单 | ✅ | |
| Stripe 支付集成 | ⬜ | |
| 订单确认页 | ✅ | |
| 订单追踪页 | ✅ | |

#### 2.5 静态页面 ✅（少量内容为占位）

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 关于我们 `/about` | ✅ | 品牌故事、团队介绍、公司历史 |
| 联系我们 `/contact` | 🔶 | 已包含地址/电话/邮箱占位，需替换为真实信息（非仅表单） |
| 隐私政策 `/privacy` | ✅ | 详细数据使用说明 |
| 服务条款 `/terms` | ✅ | |
| 退换货政策 `/returns` | ✅ | **详细退换货流程**，非模糊承诺 |
| 发货说明 `/shipping` | 🔶 | 已提供模板；物流商/费用需结合实际补充 |
| FAQ `/faq` | ✅ | FAQ Schema 结构化数据 |
| 博客列表 `/blog` | ✅ | |
| 博客详情 `/blog/[slug]` | ✅ | Article Schema + 作者信息 |
| 作者页面 `/author/[slug]` | ✅ | **作者简介、资质、文章列表**（E-E-A-T） |

#### 2.6 E-E-A-T 信任元素 ✅（部分为占位链接）

> Google E-E-A-T：Experience（经验）、Expertise（专业）、Authoritativeness（权威）、Trustworthiness（可信）

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 安全支付徽章 | ✅ | Footer/结算页展示 Stripe/PayPal 安全标识 |
| SSL 安全标识 | ✅ | 展示 HTTPS 安全连接提示 |
| 社交媒体链接 | ✅ | Footer 链接到官方 Instagram/TikTok/Facebook |
| 媒体报道展示 | ✅ | 首页/关于页展示媒体报道 logo 或截图 |
| 产品认证标识 | ✅ | 产品页展示 CE/FCC/FDA 等认证图标 |
| 第三方评价入口 | 🔶 | 入口组件已就位，需替换为真实 Trustpilot/Google Reviews 链接 |

---

### 第三阶段：后端 API 🔶 部分完成

#### 3.1 域名品牌识别（核心）✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 域名识别中间件 | ✅ | 根据 `Host` 头查询 `brands.domain` 获取 `brand_id`（`worker/src/middleware/brand.ts`） |
| 品牌信息缓存 | ✅ | 可选 KV 缓存品牌配置，减少数据库查询（绑定 `CACHE`） |
| KV 缓存键包含 Host | ✅ | KV 缓存 key 包含域名（例如 `brand:domain:{host}`），避免多域名场景缓存污染导致跨品牌数据串读 |
| 默认品牌回退 | ✅ | 未匹配域名时使用默认品牌（开发环境 localhost；`DEFAULT_BRAND_SLUG`） |
| 生产环境未匹配域名处理 | ✅ | 生产环境未匹配域名返回 404/站点未开通页（避免误落到默认品牌） |
| 品牌上下文注入 | ✅ | 所有 `/api/*` 自动携带 `brand_id`（入口注入：`worker/src/index.ts`） |

#### 3.2 基础 API 🔶 部分完成

| 功能点 | 状态 | 端点 |
|--------|------|------|
| 产品列表 | ✅ | `POST /api/products/list`（已按 `brand_id` 过滤；支持分页/筛选/排序） |
| 产品详情 | ✅ | `GET /api/products/:slug`（已按 `brand_id` 过滤；返回相关产品） |
| 分类列表 | ✅ | `GET /api/categories`（已按 `brand_id` 过滤；返回层级结构 + 分类产品数量） |
| CORS 中间件 | ✅ | |
| 错误处理 | ✅ | |
| Supabase 连接 | ✅ | |

#### 3.3 订单和支付 ✅ 已完成

| 功能点 | 状态 | 端点 |
|--------|------|------|
| 购物车验证 | ✅ | `POST /api/cart/validate`（含库存校验） |
| 创建订单 | ✅ | `POST /api/orders/create`（含 Stripe PaymentIntent） |
| 订单详情 | ✅ | `GET /api/orders/:id`（已按 `brand_id` 过滤） |
| 服务端金额/币种校验 | ✅ | `POST /api/orders/create` |
| Stripe PaymentIntent | ✅ | 创建订单时自动生成 |
| Stripe Webhook（签名验证 + 幂等） | ✅ | `POST /api/stripe/webhook`（数据库级幂等） |
| Webhook 事件去重（stripe_event_id） | ✅ | `stripe_events` 表存储已处理事件 |
| 订单状态机校验 | ✅ | 支持 pending→processing→shipped→delivered |
| 库存扣减 | ✅ | 支付成功后自动扣减，NULL 表示无限库存 |
| 邮件通知 | ✅ | Resend API 发送订单确认邮件 |

#### 3.4 AI 客服 ✅ 已完成

> **多品牌设计原则**：每个品牌拥有独立的知识库、Prompt 人设、行为配置，通过 `brand_id` 统一隔离。

**核心功能：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 普通对话 | ✅ | 🧠 AI | `POST /api/chat`（已按 `brand_id` 读取 settings） |
| 流式响应 | ✅ | 🧠 AI | `POST /api/chat/stream`，SSE 实时流式输出 |
| RAG 向量检索 | ✅ | 🧠 AI | pgvector + `match_knowledge` RPC 检索品牌知识库 |
| 知识库 CRUD | ✅ | - | `GET/POST/PUT/DELETE /api/knowledge` |
| 知识库同步 | ✅ | 🧠 AI | `POST /api/knowledge/sync` 从产品同步 |
| 多语言支持 | ✅ | 🧠 AI | AI 自动检测用户语言并回复 |
| 人工转接关键词 | ✅ | ⚙️ 配置 | 可配置触发转人工的关键词列表 |
| 前端聊天组件 | ✅ | - | `ChatWidget.astro` 悬浮聊天窗口 |

**多品牌架构设计：**

1. **向量存储方案**：单表 `knowledge_base` + `brand_id` 字段隔离
   - 使用 Supabase pgvector 扩展存储向量
   - 检索时自动按 `brand_id` 过滤
   - RLS 策略保障数据隔离

2. **品牌级配置（settings 表）**：
   | 配置项 | key | value 示例 |
   |--------|-----|------------|
   | AI 开关 | `ai_enabled` | `true` |
   | AI 人设 | `ai_persona` | `{"name": "小助手", "tone": "friendly"}` |
   | 系统提示词 | `ai_system_prompt` | `"你是{brand_name}的客服..."` |
   | 欢迎语 | `ai_welcome_message` | `"您好！有什么可以帮您？"` |
   | 转人工关键词 | `ai_handoff_keywords` | `["投诉", "退款", "人工"]` |
   | 上下文消息数 | `ai_max_context_messages` | `10` |

3. **知识库自动构建**：
   | 数据源 | 触发时机 | 向量内容 |
   |--------|----------|----------|
   | 产品 | 产品创建/更新 | 名称 + 描述 + 规格 |
   | FAQ | FAQ 创建/更新 | 问题 + 答案 |
   | 政策页 | 页面更新 | 退换货/发货/隐私政策 |
   | 博客 | 文章发布 | 标题 + 正文摘要 |

4. **RAG 检索流程**：
   ```
用户消息 → Embedding → 向量相似度搜索(brand_id过滤) 
            → Top K 知识片段 → 注入 System Prompt 
            → DeepSeek 生成回复 → 返回用户
   ```

5. **对话历史管理**：
   - 按 `session_id` 分组，保留最近 N 条消息作为上下文
   - 会话超时（如 30 分钟无消息）自动结束
   - 历史记录存入 `conversations` 表供后台查看

---

### 第四阶段：管理后台 ✅ 基础框架已完成

#### 4.1 后台框架 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 后台布局 AdminLayout | ✅ | `frontend/src/layouts/AdminLayout.astro` 响应式侧边栏 |
| 登录认证 | 🔶 | 占位，待集成 Supabase Auth |
| 仪表盘 | ✅ | `/admin` 统计卡片、快捷操作 |
| 品牌切换器 | ✅ | 顶栏品牌选择器 |
| 角色权限模型（RBAC） | ⬜ | 待开发 |

#### 4.2 产品管理 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 产品列表 | ✅ | `/admin/products` 分页、状态标签 |
| 产品编辑 | 🔶 | 链接占位，待完善编辑表单 |
| 产品创建 | 🔶 | 链接占位，待完善创建表单 |
| 批量操作 | ⬜ | 待开发 |
| 分类管理 | ⬜ | 待开发 |

#### 4.3 订单管理 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 订单列表 | ✅ | `/admin/orders` 状态筛选、分页 |
| 订单详情 | 🔶 | 链接占位 |
| 状态更新 | ✅ | 列表页直接下拉更新状态 |
| 物流信息填写 | ⬜ | 待开发 |
| 退款操作 | ⬜ | 待开发 |

#### 4.4 系统设置 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 店铺设置 | ✅ | `/admin/settings` 名称、通知邮箱 |
| 支付设置 | ⬜ | 待开发 |
| 发货设置 | ⬜ | 待开发 |

#### 4.5 内容生成 ✅ 新增

**作者管理：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 作者列表 | ✅ | `/admin/authors` 管理所有内容作者 |
| 作者创建/编辑 | ✅ | 姓名、头像、简介、资质证书、社交链接 |
| 作者关联文章 | ✅ | 查看作者发布的所有文章 |

**评价管理：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 评价列表 | ✅ | `/admin/reviews` 查看所有产品评价 |
| 评价审核 | ✅ | 审核通过/拒绝/标记垃圾，状态即时更新 |
| 购买者标识 | ✅ | 自动标记"已购买"用户的评价（`is_verified_purchase`） |
| 评价回复 | ✅ | 商家回复用户评价（`merchant_reply`） |
| 邀请评价 | ⬜ | 订单完成后自动邮件邀请评价 |

**信任元素管理：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 媒体报道管理 | ⬜ | 上传媒体 logo、报道链接、截图 |
| 产品认证管理 | ⬜ | 上传 CE/FCC/FDA 等认证图片 |
| 第三方评价配置 | ⬜ | 配置 Trustpilot/Google Reviews 链接 |
| 社交媒体配置 | ⬜ | 配置官方社交账号链接 |

---

### 第五阶段：AI 内容工具 ✅ 基础功能已完成

> ⚠️ **Google SEO 风险提示**：Google 不惩罚 AI 内容本身，但会惩罚低质量、批量生成、无价值的内容.
> 核心标准是 **E-E-A-T**：Experience（经验）、Expertise（专业）、Authoritativeness（权威）、Trustworthiness（可信）

#### 5.1 AI 内容质量防护（必须）🔶 部分完成

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 人工审核流程 | ✅ | ⚙️ 流程 | 内容生成后保存为草稿状态，可编辑后发布 |
| 原创度检测 | ⬜ | 🧠 AI | 待开发 |
| AI 内容标识 | ⬜ | 🤖 自动 | 待开发 |
| 内容差异化引擎 | ✅ | 🧠 AI | AI 自动融入真实产品数据、价格、折扣信息 |
| 作者署名系统 | ⬜ | ⚙️ 配置 | 待开发 |
| 发布频率限制 | ⬜ | 🤖 自动 | 待开发 |
| 内容更新提醒 | ⬜ | 🤖 自动 | 待开发 |
| UGC 混合策略 | ⬜ | 🤖 自动 | 待开发 |

#### 5.2 视频脚本生成 ✅ 基础功能已完成

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 产品选择 | ✅ | - | `/admin/content` 下拉选择产品 |
| 视频类型选择 | ✅ | - | 开箱/测评/教程/促销 |
| 脚本生成 | ✅ | 🧠 AI | `POST /api/content/generate/script` Hook + 主体 + CTA |
| 配乐推荐 | ✅ | 🧠 AI | AI 在脚本末尾推荐音乐风格 |
| Hashtag 推荐 | ✅ | 🧠 AI | AI 在脚本末尾生成相关标签 |
| 批量生成 | ⬜ | 🧠 AI | 待开发 |
| 脚本库 | ✅ | - | `content_library` 表存储，可查看/删除 |
| 脚本变体生成 | ⬜ | 🧠 AI | 待开发 |

#### 5.3 文案生成 ✅ 基础功能已完成

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 产品描述（长） | ✅ | 🧠 AI | `POST /api/content/generate/copy` copyType=long_description |
| 产品描述（短） | ✅ | 🧠 AI | copyType=short_description |
| 社交媒体文案 | ✅ | 🧠 AI | copyType=social_post，支持多平台 |
| 邮件营销文案 | ✅ | 🧠 AI | copyType=email |
| 多语言翻译 | ⬜ | 🧠 AI | 待开发 |
| 文案库 | ✅ | - | `content_library` 表存储 |
| A/B 文案变体 | ⬜ | 🧠 AI | 待开发 |
| 语气风格调整 | ✅ | 🧠 AI | 支持 casual/professional/playful/luxury/informative |

---

### 第六阶段：数据分析 ✅ 基础功能已完成
#### 6.1 数据看板 ✅

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 销售概览 | ✅ | `/admin/analytics` 今日/30天销售额、订单数、AOV |
| 销售趋势图 | ✅ | Chart.js 按天的销售曲线，支持切换收入/订单 |
| 产品排行榜 | ✅ | 收入 Top 10 产品列表 |
| 客户分析 | ✅ | `/api/analytics/customers` 新客/老客、复购率、LTV |
| 利润分析 | ⬜ | 待开发（需成本数据） |
| 流量来源 | ⬜ | 待开发（需埋点数据） |
| 转化漏斗 | ✅ | `/api/analytics/funnel` 订单→支付→发货→送达 |

---
### 第七阶段：高级 SEO 工具 ⬜ 待开发
> 基础 SEO 已在第二阶段内置，本阶段为高级功能

#### 7.1 页面级 SEO 优化

**Meta 标签管理：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| Title 标签编辑器 | ⬜ | ⚙️ 配置 | 支持变量模板：`{产品名} - {分类} | {品牌}`，实时字符计数（推荐 50-60 字符） |
| Description 编辑器 | ⬜ | ⚙️ 配置 | 实时预览 Google 搜索结果片段，字符计数（推荐 150-160 字符） |
| 关键词密度分析 | ⬜ | 🤖 自动 | 自动分析目标关键词在标题/描述/正文中的出现频率，建议 1-3% |
| 重复 Meta 检测 | ⬜ | 🤖 自动 | 自动扫描全站，标记重复的 title/description 页面 |
| 批量 Meta 生成 | ⬜ | 🧠 AI | AI 根据产品信息批量生成 title/description |

**结构化数据管理：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| Schema 验证器 | ⬜ | 🤖 自动 | 自动调用 Google Rich Results Test API 验证标记正确性 |
| Review Schema | ⬜ | 🤖 自动 | 产品评价结构化数据，根据评价数据自动生成 |
| FAQ Schema 编辑器 | ⬜ | ⚙️ 配置 | 可视化编辑 FAQ 结构化数据 |

**社交分享优化：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| Open Graph 编辑器 | ⬜ | ⚙️ 配置 | 编辑 og:title、og:description、og:image |
| 分享预览模拟器 | ⬜ | 🤖 自动 | 实时预览 Facebook/Twitter/LinkedIn/微信分享卡片效果 |
| 分享图片生成 | ⬜ | 🧠 AI | AI 自动生成 1200x630 社交分享图 |

**图片 SEO：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| Alt 文本检查 | ⬜ | 🤖 自动 | 自动扫描缺失 alt 属性的图片 |
| Alt 文本 AI 建议 | ⬜ | 🧠 AI | AI 分析图片内容，自动建议描述文本 |
| 文件名优化 | ⬜ | 🧠 AI | AI 检测无意义文件名，建议语义化命名 |
| 图片压缩 | ⬜ | 🤖 自动 | 上传时自动压缩 > 200KB 图片，保持视觉质量 |
| WebP 转换 | ⬜ | 🤖 自动 | 上传时自动生成 WebP 格式 |
| 懒加载检查 | ⬜ | 🤖 自动 | 自动检测首屏外图片是否配置 `loading="lazy"` |
| 图片尺寸声明 | ⬜ | 🤖 自动 | 自动检测缺失 width/height 属性 |

**内链优化：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 孤立页面检测 | ⬜ | 🤖 自动 | 自动发现无内链指向的页面 |
| 内链密度分析 | ⬜ | 🤖 自动 | 自动分析每个页面的出站/入站内链数量 |
| 锚文本分析 | ⬜ | 🤖 自动 | 自动检测锚文本多样性，避免过度优化 |
| 相关内容 AI 推荐 | ⬜ | 🧠 AI | AI 分析内容相关性，自动生成内链建议 |
| 内链结构可视化 | ⬜ | 🤖 自动 | 自动生成站内链接拓扑结构图 |

#### 7.2 技术 SEO

**爬虫控制：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| Sitemap 管理界面 | ⬜ | 查看/手动刷新 sitemap |
| Sitemap 分片 | ⬜ | 超过 50,000 URL 自动分片，生成 sitemap index |
| Sitemap 提交 | ⬜ | 一键提交到 Google Search Console |
| Robots.txt 编辑器 | ⬜ | 可视化编辑，语法高亮，规则测试 |
| Robots 规则测试 | ⬜ | 输入 URL 测试是否被 Allow/Disallow |
| Crawl Budget 分析 | ⬜ | 分析爬虫抓取频率，优化抓取预算分配 |

**URL 与重定向：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| URL 结构检查 | ⬜ | 检测过长 URL（>75 字符）、特殊字符、大写字母 |
| Canonical 标签管理 | ⬜ | 检测自引用/跨域 canonical 问题 |
| 301 重定向管理 | ⬜ | 批量导入/导出重定向规则，支持正则匹配 |
| 重定向链检测 | ⬜ | 检测 A→B→C 多跳重定向，建议直接 A→C |
| 404 页面监控 | ⬜ | 实时监控 404 错误，自动建议重定向目标 |
| URL 参数处理 | ⬜ | 配置 Google 忽略的 URL 参数（如 utm_*） |

**页面性能（Core Web Vitals）：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| LCP 监控 | ⬜ | Largest Contentful Paint，目标 < 2.5s |
| FID 监控 | ⬜ | First Input Delay，目标 < 100ms |
| CLS 监控 | ⬜ | Cumulative Layout Shift，目标 < 0.1 |
| INP 监控 | ⬜ | Interaction to Next Paint（新指标），目标 < 200ms |
| TTFB 分析 | ⬜ | Time to First Byte，服务器响应时间 |
| 性能趋势图 | ⬜ | 按天/周/月展示 Core Web Vitals 变化趋势 |
| 优化建议生成 | ⬜ | 根据性能数据自动生成具体优化建议 |

**移动端 SEO：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 移动友好测试 | ⬜ | 调用 Google Mobile-Friendly Test API |
| 视口配置检查 | ⬜ | 检测 `<meta name="viewport">` 配置 |
| 触控目标检查 | ⬜ | 检测按钮/链接尺寸是否 ≥ 48x48px |
| 字体大小检查 | ⬜ | 检测正文字体是否 ≥ 16px |
| 移动端预览 | ⬜ | 模拟 iPhone/Android 设备预览页面 |

**安全与协议：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| HTTPS 检查 | ⬜ | 检测混合内容（HTTP 资源在 HTTPS 页面） |
| SSL 证书监控 | ⬜ | 证书到期提前 30 天提醒 |
| HSTS 配置检查 | ⬜ | 检测 Strict-Transport-Security 头 |

#### 7.3 内容 SEO

**关键词研究：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 种子词扩展 | ⬜ | 🧠 AI | 输入核心词，AI 生成 50+ 相关长尾词 |
| 搜索意图分类 | ⬜ | 🧠 AI | AI 自动分类：信息型/导航型/交易型/商业调查型 |
| 关键词难度评估 | ⬜ | 🧠 AI | AI 基于竞争度评估排名难度（1-100 分） |
| 搜索量估算 | ⬜ | 🤖 自动 | 接入第三方 API 自动获取月均搜索量 |
| 关键词分组 | ⬜ | 🧠 AI | AI 按主题/意图自动聚类关键词 |
| 竞品关键词分析 | ⬜ | 🧠 AI | AI 分析竞品排名关键词，发现机会词 |

**内容优化：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 内容评分系统 | ⬜ | 🧠 AI | AI 综合评分：关键词使用、可读性、长度、结构 |
| 可读性分析 | ⬜ | 🤖 自动 | 自动计算 Flesch Reading Ease 评分，建议句子长度 |
| 标题层级检查 | ⬜ | 🤖 自动 | 自动检测 H1-H6 使用是否规范 |
| 内容长度建议 | ⬜ | 🧠 AI | AI 根据关键词竞争度建议最佳内容长度 |
| 关键词分布热力图 | ⬜ | 🤖 自动 | 自动生成关键词在页面中的分布可视化 |
| TF-IDF 分析 | ⬜ | 🧠 AI | AI 分析内容与 SERP 前 10 的语义相关性 |
| 内容差距分析 | ⬜ | 🧠 AI | AI 对比竞品内容，发现缺失的子主题 |

**AI 内容生成（遵循质量防护）：**

> ⚠️ 所有 AI 生成内容必须经过第五阶段定义的质量防护流程

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 博客文章生成 | ⬜ | 🧠 AI | 输入关键词，AI 生成 1500-3000 字 SEO 文章，**必须人工审核后发布** |
| 文章大纲生成 | ⬜ | 🧠 AI | AI 生成文章结构大纲，支持手动调整 |
| 产品描述优化 | ⬜ | 🧠 AI | AI 重写产品描述，**自动融入真实规格参数** |
| FAQ 生成 | ⬜ | 🧠 AI | AI 优先基于真实客服记录生成，其次补充常见问题 |
| 多语言翻译 | ⬜ | 🧠 AI | AI 翻译内容，保持 SEO 元素（非直译） |
| 内容原创度检测 | ⬜ | 🧠 AI | AI 检测生成内容的原创性，**相似度 > 30% 禁止发布** |
| E-E-A-T 评分 | ⬜ | 🧠 AI | AI 评估内容的经验/专业/权威/可信度，低分内容标记优化 |

#### 7.4 监控与报告

**排名追踪：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 关键词排名监控 | ⬜ | 每日追踪目标关键词在 Google 的排名 |
| 排名变化提醒 | ⬜ | 排名上升/下降超过 5 位时邮件提醒 |
| 竞品排名对比 | ⬜ | 同一关键词下与竞品的排名对比 |
| SERP 特性追踪 | ⬜ | 追踪是否出现在精选摘要/People Also Ask |
| 本地排名追踪 | ⬜ | 按地区追踪排名（美国/英国/澳洲等） |
| 历史排名图表 | ⬜ | 可视化展示排名变化趋势 |

**索引监控：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 索引状态检查 | ⬜ | 批量检测页面是否被 Google 收录 |
| 索引覆盖率报告 | ⬜ | 统计已索引/未索引/排除的页面数量 |
| 索引请求提交 | ⬜ | 新页面一键提交 Google 索引请求 |
| 索引异常提醒 | ⬜ | 重要页面被移除索引时邮件提醒 |
| Search Console 集成 | ⬜ | 同步 Google Search Console 数据 |

**SEO 健康评分：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 综合健康评分 | ⬜ | 0-100 分，综合技术/内容/外链等维度 |
| 问题优先级排序 | ⬜ | 按影响程度排序：严重/警告/建议 |
| 修复进度追踪 | ⬜ | 标记已修复问题，追踪修复进度 |
| 竞品健康对比 | ⬜ | 与竞品 SEO 健康度对比分析 |

**自动化报告：**
| 功能点 | 状态 | 说明 |
|--------|------|------|
| 周报自动生成 | ⬜ | 每周一自动生成并邮件发送 |
| 月报自动生成 | ⬜ | 每月 1 日生成月度 SEO 表现报告 |
| 自定义报告模板 | ⬜ | 选择报告包含的指标和图表 |
| PDF/Excel 导出 | ⬜ | 支持导出为 PDF 或 Excel 格式 |
| 多品牌汇总报告 | ⬜ | 汇总所有品牌的 SEO 表现（管理员视图） |

#### 7.5 GEO 生成式引擎优化 ⬜

> **GEO（Generative Engine Optimization）**：针对 AI 搜索引擎（ChatGPT、Perplexity、Google AI Overview、Bing Copilot）的优化
> 
> 传统 SEO 优化的是"网页排名"，GEO 优化的是"AI 回答中被引用的概率"

**AI 爬虫管理：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| AI 爬虫识别 | ⬜ | 🤖 自动 | 自动识别 GPTBot、ClaudeBot、PerplexityBot、Google-Extended 等 |
| robots.txt AI 规则 | ⬜ | ⚙️ 配置 | 配置允许/禁止 AI 爬虫抓取（建议允许以获取 AI 流量） |
| AI 爬虫日志 | ⬜ | 🤖 自动 | 自动记录 AI 爬虫访问频率、抓取页面 |

**内容结构优化（AI 友好）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 问答格式检测 | ⬜ | 🤖 自动 | 自动检测内容是否包含清晰的 Q&A 结构 |
| 列表/表格使用率 | ⬜ | 🤖 自动 | 自动分析内容中列表、表格占比 |
| 段落长度优化 | ⬜ | 🧠 AI | AI 建议段落 2-4 句，自动标记过长段落 |
| 摘要/TL;DR 生成 | ⬜ | 🧠 AI | AI 为长文自动生成摘要段落 |
| 定义式开头检测 | ⬜ | 🧠 AI | AI 检测文章是否以"X 是..."开头，自动建议优化 |

**引用与可信度：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 数据来源标注 | ⬜ | 🧠 AI | AI 提示添加统计数据来源 |
| 外部引用检测 | ⬜ | 🤖 自动 | 自动检测是否引用权威来源 |
| 专家引言建议 | ⬜ | 🧠 AI | AI 建议添加行业专家观点/引言 |
| 发布日期显示 | ⬜ | 🤖 自动 | 自动确保内容显示发布/更新日期 |
| 作者专业背景 | ⬜ | ⚙️ 配置 | 作者页展示资质，AI 评估内容可信度 |

**品牌可见性：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 品牌名提及优化 | ⬜ | 🧠 AI | AI 确保品牌名在内容中自然出现 2-3 次 |
| 品牌+产品关联 | ⬜ | 🧠 AI | AI 在内容中建立"品牌名 + 产品类型"的关联 |
| 独特卖点强调 | ⬜ | 🧠 AI | AI 突出产品独特卖点 |
| 对比内容创建 | ⬜ | 🧠 AI | AI 创建"X vs Y"对比内容 |

**AI 搜索监控：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| AI 引用追踪 | ⬜ | 🤖 自动 | 定时监控品牌/产品是否被 ChatGPT、Perplexity 等引用 |
| AI 回答截图 | ⬜ | 🤖 自动 | 定期自动截图 AI 对相关问题的回答 |
| 竞品 AI 可见性 | ⬜ | 🤖 自动 | 自动对比竞品在 AI 回答中的出现频率 |
| AI 流量来源 | ⬜ | 🤖 自动 | 自动识别来自 AI 搜索的流量（Referrer 分析） |

**GEO 内容策略：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 问题库建设 | ⬜ | 🧠 AI | AI 收集用户可能问 AI 的问题 |
| 长尾问题覆盖 | ⬜ | 🧠 AI | AI 生成"如何选择..."、"X 和 Y 哪个好"等长尾问题内容 |
| 产品使用指南 | ⬜ | 🧠 AI | AI 创建详细使用教程 |
| 行业知识内容 | ⬜ | 🧠 AI | AI 创建行业科普内容 |
| 本地化内容 | ⬜ | 🧠 AI | AI 针对不同地区创建本地化内容 |

---

### 第八阶段：多品牌管理 ⬜ Phase2

#### 8.1 品牌管理 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 品牌创建 | ⬜ | 名称、Slug、域名 |
| 品牌编辑 | ⬜ | Logo、设置、主题色 |
| 域名绑定配置 | ⬜ | 绑定独立域名，DNS 指引 |
| 品牌主题定制 | ⬜ | 颜色、字体、布局风格 |
| 用户权限分配 | ⬜ | 品牌管理员、编辑、只读 |
| 品牌启用/禁用 | ⬜ | 临时下线品牌 |

#### 8.2 协作管理 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 总后台 | ⬜ | 超级管理员视图，切换品牌 |
| 品牌独立后台 | ⬜ | 品牌管理员只能看到自己的品牌 |
| 跨品牌数据看板 | ⬜ | 汇总所有品牌的销售数据 |
| 知识库共享 | ⬜ | AI 知识库跨品牌复用 |
| 模板共享 | ⬜ | 邮件模板、脚本模板跨品牌复用 |

---

### 第九阶段：流量与转化 ⬜ 待开发

> 海外电商流量获取与用户留存核心模块

#### 9.1 广告追踪像素 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| Facebook Pixel 集成 | ⬜ | 页面浏览、加购、发起结算、购买等事件追踪 |
| Google Ads 转化追踪 | ⬜ | Google Ads 转化标签，ROAS 优化 |
| TikTok Pixel | ⬜ | TikTok 广告转化追踪 |
| Pinterest Tag | ⬜ | Pinterest 广告追踪（可选） |
| 像素配置界面 | ⬜ | 后台填写各平台 Pixel ID，无需改代码 |
| 服务端事件 | ⬜ | Conversions API（绕过浏览器拦截，提高追踪准确率） |
| 统一事件追踪层 | ⬜ | 内部统一 `track(event, payload)`，再映射到各平台像素/事件，减少多平台与多品牌维护成本 |
| 事件去重与一致性校验 | ⬜ | 为关键事件生成 event_id，并保证前端像素与服务端 CAPI 事件可对齐（同订单号/金额/货币） |

**标准电商事件：**
| 事件 | 触发时机 | 用途 |
|------|----------|------|
| PageView | 页面加载 | 基础流量统计 |
| ViewContent | 产品详情页 | 兴趣用户 |
| AddToCart | 加入购物车 | 高意向用户 |
| InitiateCheckout | 进入结算页 | 准购买用户 |
| Purchase | 支付成功 | 转化用户，计算 ROAS |

#### 9.2 UTM 参数追踪 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| UTM 参数解析 | ⬜ | 自动解析 utm_source/medium/campaign/content/term |
| 来源归因存储 | ⬜ | 订单关联流量来源，分析各渠道 ROI |
| 来源报表 | ⬜ | 按来源统计订单数、销售额、转化率 |
| 首次/末次归因 | ⬜ | 支持首次触达和末次触达两种归因模型 |
| 归因窗口与 TTL 策略 | ⬜ | 明确首次/末次归因保存窗口与 TTL（如 first_touch 30-90 天、last_touch 7-30 天），并在创建订单时落库 |

#### 9.3 邮件营销自动化 ⬜

> 海外用户习惯邮件沟通，邮件营销是独立站核心转化手段

**交易邮件（必须）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 订单确认邮件 | ⬜ | 🤖 自动 | 支付成功后自动发送 |
| 发货通知邮件 | ⬜ | 🤖 自动 | 填写物流单号后自动发送，含追踪链接 |
| 送达确认邮件 | ⬜ | 🤖 自动 | 物流签收后自动发送（可选） |

**弃购挽回（高 ROI）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 弃购检测 | ⬜ | 🤖 自动 | 自动检测用户填写邮箱但未完成支付，标记为弃购 |
| 弃购邮件 #1 | ⬜ | 🤖 自动 | **1 小时后**自动发送，提醒购物车商品 |
| 弃购邮件 #2 | ⬜ | 🤖 自动 | **24 小时后**自动发送，强调库存紧张/限时优惠 |
| 弃购邮件 #3 | ⬜ | 🤖 自动 | **72 小时后**自动发送，提供小额折扣码 |
| 弃购邮件内容 | ⬜ | 🧠 AI | AI 生成个性化弃购挽回邮件内容 |
| 弃购转化统计 | ⬜ | 🤖 自动 | 自动统计挽回成功率、挽回金额 |

**营销邮件：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 欢迎邮件序列 | ⬜ | 🤖 自动 | 新订阅用户自动发送 3 封欢迎邮件 |
| 欢迎邮件内容 | ⬜ | 🧠 AI | AI 生成品牌故事/热销/首单优惠邮件内容 |
| 复购提醒 | ⬜ | 🤖 自动 | 购买 30/60/90 天后自动提醒复购 |
| 节日营销 | ⬜ | 🧠 AI | AI 生成黑五/圣诞/新年等节日促销邮件 |
| 新品通知 | ⬜ | 🤖 自动 | 新品上架自动通知订阅用户 |
| 邮件模板编辑器 | ⬜ | ⚙️ 配置 | 可视化编辑邮件模板，支持变量插入 |
| 发送时间优化 | ⬜ | 🧠 AI | AI 根据用户时区和行为选择最佳发送时间 |

**邮件合规：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 退订链接 | ⬜ | 🤖 自动 | 每封邮件自动包含一键退订链接（GDPR/CAN-SPAM） |
| 退订管理 | ⬜ | 🤖 自动 | 退订用户自动不再发送营销邮件 |
| 发送频率限制 | ⬜ | 🤖 自动 | 系统自动限制发送频率，避免过度发送 |
| 订阅偏好与营销授权 | ⬜ | 🤖 自动 | 区分交易邮件与营销邮件；记录用户营销订阅状态（opt-in/opt-out）并确保退订后仅停止营销邮件 |
| 弃购判定防误伤 | ⬜ | 🤖 自动 | 弃购检测需排除已支付/已下单用户；支付失败场景建议使用独立触达策略（非弃购同一套规则） |

#### 9.4 优惠券系统 ⬜

| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 优惠券创建 | ⬜ | ⚙️ 配置 | 固定金额/百分比折扣 |
| 使用条件 | ⬜ | ⚙️ 配置 | 最低消费、指定产品/分类、首单专享 |
| 有效期设置 | ⬜ | ⚙️ 配置 | 开始/结束时间 |
| 使用次数限制 | ⬜ | ⚙️ 配置 | 总次数/每用户次数 |
| 优惠码生成 | ⬜ | 🤖 自动 | 自定义码或系统自动生成随机码 |
| 优惠码验证 | ⬜ | 🤖 自动 | 结算时自动验证优惠码有效性 |
| 使用统计 | ⬜ | 🤖 自动 | 自动统计使用次数、带来的销售额 |

#### 9.5 用户留存 ⬜

**会员系统（可选）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 积分获取 | ⬜ | 🤖 自动 | 购物自动得积分（$1 = 1 积分） |
| 积分兑换 | ⬜ | 🤖 自动 | 积分自动抵扣现金或兑换优惠券 |
| 会员等级 | ⬜ | 🤖 自动 | 根据消费金额自动升降级：普通/银牌/金牌 |

**推荐有礼（联盟营销）：**
| 功能点 | 状态 | 自动化 | 说明 |
|--------|------|--------|------|
| 推荐码生成 | ⬜ | 🤖 自动 | 每个用户自动生成专属推荐码/链接 |
| 推荐追踪 | ⬜ | 🤖 自动 | 自动追踪推荐来源 |
| 推荐奖励 | ⬜ | 🤖 自动 | 推荐成功后自动发放优惠券/积分/现金 |
| 被推荐人优惠 | ⬜ | 🤖 自动 | 新用户通过推荐链接自动获得首单折扣 |
| 推荐统计 | ⬜ | 🤖 自动 | 自动统计推荐人数、带来的订单、佣金 |

---

### 第十阶段：部署运维 ⬜ 待开发

#### 10.1 部署配置 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| Cloudflare Pages 部署 | ⬜ | 前端静态站点部署 |
| Cloudflare Workers 部署 | ⬜ | API 边缘部署 |
| 多域名绑定 | ⬜ | 独立域名模式配置 |
| GitHub Actions CI/CD | ⬜ | 自动构建、测试、部署 |
| 环境变量管理 | ⬜ | 开发/预发/生产环境配置 |

#### 10.2 监控维护 ⬜

| 功能点 | 状态 | 说明 |
|--------|------|------|
| 日志查看 | ⬜ | Cloudflare Workers 日志 |
| 关键路径结构化日志 | ⬜ | 对订单创建、Stripe Webhook、AI 对话等关键接口记录 request_id、brand_id、order_id 等字段，便于追踪排障 |
| 性能监控 | ⬜ | 请求延迟、错误率 |
| 备份策略 | ⬜ | Supabase 数据库定期备份 |
| 安全检查 | ⬜ | 依赖漏洞扫描、密钥轮换 |
| 告警配置 | ⬜ | 错误率/延迟超阈值时通知（重点覆盖支付回调失败、订单创建失败等关键链路） |

---

## 项目结构

```
B2C_AI_System/
├── frontend/                 # Astro 前端 ✅
│   ├── src/
│   │   ├── pages/           # 页面
│   │   ├── components/      # 组件
│   │   ├── layouts/         # 布局
│   │   ├── lib/             # 工具库
│   │   └── styles/          # 样式
│   └── public/              # 静态资源
│
├── worker/                   # Cloudflare Worker 后端 ✅
│   └── src/
│       ├── routes/          # API 路由
│       └── utils/           # 工具函数
│
├── docs/                     # 文档 ✅
│   ├── database/            # 数据库脚本
│   └── 功能文档.md          # 本文档
│
└── README.md                 # 项目说明 ✅
```

---

## 状态图例

| 图标 | 含义 |
|------|------|
| ✅ | 已完成 |
| 🔶 | 部分完成/占位 |
| ⬜ | 待开发 |

---

## 开发顺序总结

| 阶段 | 内容 | 依赖 |
|------|------|------|
| 1 | 项目初始化 ✅ | - |
| 2 | 前端页面 + 基础 SEO | 阶段 1 |
| 3 | 后端 API（含域名品牌识别） | 阶段 1 |
| 4 | 管理后台 | 阶段 2、3 |
| 5 | AI 内容工具 | 阶段 3、4 |
| 6 | 数据分析 | 阶段 3、4 |
| 7 | 高级 SEO 工具 | 阶段 2、4 |
| 8 | 多品牌管理 | 阶段 3、4 |
| 9 | 流量与转化（广告追踪、邮件营销、优惠券） | 阶段 2、3、4 |
| 10 | 部署运维 | 全部 |

---

## 下一步计划

**下次会话应执行：**
1. 步骤 2.1：基础 SEO 补充（canonical、Schema、sitemap、robots.txt）
2. 步骤 2.2：首页和布局组件完善
3. 步骤 2.3：产品列表和详情页

**环境准备：**
1. 创建 Supabase 项目并运行 SQL 脚本
2. 配置 `.env` 文件
3. 启动开发服务器验证