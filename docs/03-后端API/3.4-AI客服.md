# 3.4 AI客服

## 功能概述

实现基于DeepSeek的AI客服系统，支持RAG知识库检索和流式响应。

## API端点

### 对话API ([`chat.ts`](../../worker/src/routes/chat.ts))

**POST /api/chat** - 普通对话
- 接收用户消息
- RAG知识库检索
- 调用DeepSeek生成回复
- 保存对话历史

**POST /api/chat/stream** - 流式响应
- Server-Sent Events
- 实时流式输出
- 更好的用户体验

### 知识库API ([`knowledge.ts`](../../worker/src/routes/knowledge.ts))

**POST /api/knowledge** - 添加知识
- 生成向量嵌入
- 存储到pgvector

**GET /api/knowledge** - 知识列表
- 按brand_id过滤

**DELETE /api/knowledge/:id** - 删除知识

## RAG检索

使用pgvector进行向量相似度检索：
- 查询嵌入生成
- Top-K检索（K=5）
- 相关知识注入Prompt

## 品牌配置

每个品牌独立配置：
- AI人设
- 知识库
- 转接关键词

## 相关文档

- [AI客服系统详细实现指南](./3.4-AI客服系统实现指南.md) - 完整的技术实现文档

## 状态

⏳ **待开发** - AI客服功能规划中

**注意**: 虽然标记为待开发，但实际上核心功能已经实现。详见[实现指南](./3.4-AI客服系统实现指南.md)。