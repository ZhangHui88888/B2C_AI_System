# DTC 独立站系统 - 开发计划

> 基于功能文档，按步骤开发完整的独立站系统
> 每个步骤包含开发目标、自动化说明和参考提示词

---

## 自动化图例

| 图标 | 含义 | 说明 |
|------|------|------|
| 🤖 自动 | 代码自动执行 | 无需人工干预，系统自动完成 |
| 🧠 AI | AI 辅助生成 | AI 生成内容，人工审核/确认 |
| ⚙️ 配置 | 需要配置 | 人工配置规则，系统按规则执行 |
| - | 手动操作 | 需要人工完成 |

---

## 开发进度总览

| 阶段 | 内容 | 状态 |
|------|------|------|
| 第1阶段 | 项目初始化 | ✅ 已完成 |
| 第2阶段 | 前端页面 + 基础 SEO/GEO | ✅ 已完成 |
| 第3阶段 | 后端 API | 🔶 部分完成 |
| 第4阶段 | 管理后台 | ⬜ 待开发 |
| 第5阶段 | AI 内容工具 | ⬜ 待开发 |
| 第6阶段 | 数据分析 | ⬜ 待开发 |
| 第7阶段 | 高级 SEO/GEO 工具 | ⬜ 待开发 |
| 第8阶段 | 多品牌管理 | ⬜ 待开发 |
| 第9阶段 | 流量与转化 | ⬜ 待开发 |
| 第10阶段 | 部署运维 | ⬜ 待开发 |

---

## 第2阶段：前端页面 + 基础 SEO/GEO

### 步骤 2.1：基础 SEO/GEO 补充

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| canonical 标签 | 🤖 自动 | 代码根据当前 URL 自动生成 |
| 列表筛选/排序/分页 URL 规范 | 🤖 自动 | 定义筛选/排序/分页 URL 策略，避免重复内容（与 canonical/robots/noindex 联动） |
| URL 参数索引策略 | ⚙️ 配置 | 定义 `?sort=`、`?page=`、`?utm_*` 等参数页面是否允许索引，并与 canonical/noindex 保持一致 |
| Product Schema | 🤖 自动 | 根据产品数据自动生成 JSON-LD |
| BreadcrumbList Schema | 🤖 自动 | 根据页面路径自动生成 |
| Organization Schema | 🤖 自动 | 根据品牌设置自动生成 |
| FAQ Schema | 🤖 自动 | 根据 FAQ 内容自动生成 |
| sitemap.xml | 🤖 自动 | 产品/分类/博客变更时自动更新 |
| robots.txt | ⚙️ 配置 | 含 AI 爬虫规则，后台可配置 |
| 发布日期组件 | 🤖 自动 | 自动显示发布/更新日期 |
| 作者信息组件 | 🤖 自动 | 自动关联作者信息 |
| 摘要/TL;DR 区域 | 🧠 AI | AI 自动生成摘要，人工可编辑 |
| 定义式段落 | 🧠 AI | AI 自动生成"X 是..."定义开头 |

**提示词：**
```
根据功能文档 2.1 基础 SEO + GEO，完成以下开发：

1. Layout.astro 添加 canonical 标签（🤖自动根据当前 URL 生成）

1.1 列表页 URL 规范（/products、/category）：
   - 定义筛选/排序/分页参数（如 sort、page、price_min、price_max、category）
   - 明确哪些组合页允许索引，哪些需要 noindex
   - canonical 与 noindex/robots 规则保持一致

1.2 UTM 与追踪参数策略：
   - 对 `utm_*`、`fbclid` 等追踪参数页面设置 canonical 到无参数 URL
   - 配置是否对带参数 URL 设置 noindex（按策略执行）

2. 创建 Schema 组件（frontend/src/components/seo/）：
   - ProductSchema.astro：根据产品数据自动生成 JSON-LD
   - BreadcrumbSchema.astro：根据页面路径自动生成
   - OrganizationSchema.astro：根据品牌设置自动生成
   - FAQSchema.astro：根据 FAQ 数据自动生成

3. 创建 sitemap.xml 动态生成端点（🤖自动）：
   - 自动包含所有产品、分类、博客页面
   - 产品/分类变更时自动更新

4. 创建 robots.txt：
   - 允许 GPTBot/ClaudeBot/PerplexityBot 抓取
   - 预留后台配置接口

5. 创建 GEO 相关组件（frontend/src/components/geo/）：
   - PublishDate.astro：自动显示发布日期和更新日期
   - AuthorInfo.astro：自动关联作者头像、姓名、简介
   - Summary.astro：摘要区域（支持 AI 生成 + 手动编辑）
   - QABlock.astro：问答格式组件
   - DefinitionParagraph.astro：定义式段落组件
```

---

### 步骤 2.2：首页和布局组件

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| Header 导航 | 🤖 自动 | 根据分类数据自动生成导航菜单 |
| 热销产品轮播 | 🤖 自动 | 自动获取销量 Top N 产品 |
| 分类展示网格 | 🤖 自动 | 自动获取分类数据 |
| ProductCard | 🤖 自动 | 根据产品数据自动渲染 |

**提示词：**
```
根据功能文档 2.2，完善首页和布局组件：

1. Header 组件（frontend/src/components/layout/Header.astro）：
   - 响应式导航菜单（🤖根据分类数据自动生成）
   - 移动端汉堡菜单
   - 购物车图标 + 数量徽章
   - 搜索框

2. Footer 组件（frontend/src/components/layout/Footer.astro）：
   - 链接分组（关于、政策、联系）
   - 社交媒体链接
   - 支付方式图标
   - 版权信息

3. 首页（frontend/src/pages/index.astro）：
   - Hero 区域：大图/视频背景 + CTA 按钮
   - 热销产品轮播（🤖自动获取销量 Top 8）
   - 分类网格（🤖自动获取分类数据）
   - 社会证明区域：评价/媒体报道
   - Email 订阅表单

4. 通用组件：
   - ProductCard.astro：产品卡片（🤖根据数据自动渲染）
   - CategoryCard.astro：分类卡片
```

---

### 步骤 2.3：产品页面

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 筛选栏 | 🤖 自动 | 根据数据自动生成筛选项 |
| 分页 | 🤖 自动 | 自动计算分页 |
| 规格表格 | 🤖 自动 | 规格数据自动渲染为表格 |
| 相关产品 | 🤖 自动 | 算法自动匹配同分类/标签产品 |

**提示词：**
```
根据功能文档 2.3，开发产品相关页面：

1. /products 列表页（frontend/src/pages/products/index.astro）：
   - 左侧筛选栏（🤖根据分类/价格区间自动生成筛选项）
   - 产品网格（响应式：1/2/3/4 列）
   - 排序选择：价格、销量、上新
   - 分页组件（🤖自动计算）

2. /products/[slug] 详情页（frontend/src/pages/products/[slug].astro）：
   - 图片画廊：主图 + 缩略图切换
   - 价格显示（原价/促销价）
   - 数量选择器
   - 加入购物车按钮
   - 产品 Tab：
     - 描述（支持富文本）
     - 规格（🤖自动渲染为结构化表格）
     - 发货信息
   - 相关产品推荐（🤖算法自动匹配同分类/标签）
   - 集成 ProductSchema（🤖自动生成）

3. /category/[slug] 分类页（frontend/src/pages/category/[slug].astro）：
   - 复用产品列表组件
   - 分类描述区域
   - 子分类导航
```

---

### 步骤 2.4：购物车和结算

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 购物车状态 | 🤖 自动 | 本地存储自动同步 |
| 优惠码验证 | 🤖 自动 | 自动验证有效性 |
| Stripe 支付 | 🤖 自动 | 支付流程自动处理 |

**提示词：**
```
根据功能文档 2.4，开发购物车和结算流程：

1. 迷你购物车侧边栏（frontend/src/components/cart/MiniCart.astro）：
   - 滑出式侧边栏
   - 商品列表（图片、名称、数量、价格）
   - 数量调整 +/-
   - 删除按钮
   - 小计金额
   - 去结算按钮

2. /cart 购物车页面（frontend/src/pages/cart.astro）：
   - 完整商品列表
   - 数量调整/删除
   - 优惠码输入（🤖自动验证有效性）
   - 订单摘要（小计、运费、折扣、总计）
   - 继续购物 / 去结算按钮

3. /checkout 结算页（frontend/src/pages/checkout.astro）：
   - 步骤指示器：信息 → 支付 → 确认
   - 收货地址表单（姓名、地址、城市、邮编、国家、电话）
   - 订单摘要
   - Stripe Elements 支付表单（🤖自动处理支付流程）

4. 订单确认页（frontend/src/pages/order/[id].astro）：
   - 订单号、状态
   - 商品清单
   - 收货地址
   - 支付信息

5. 订单追踪页（frontend/src/pages/order/[id]/track.astro）：
   - 物流状态时间线
   - 快递单号、物流链接
```

---

### 步骤 2.5：静态页面

**提示词：**
```
根据功能文档 2.5，创建静态页面：

1. 基础页面（frontend/src/pages/）：
   - /about：品牌故事、团队介绍、公司历史
   - /contact：真实地址、电话、邮箱 + 联系表单
   - /privacy：隐私政策（详细数据使用说明）
   - /terms：服务条款
   - /returns：退换货政策（详细流程）
   - /shipping：发货说明（时效、费用、物流商）

2. /faq 页面（frontend/src/pages/faq.astro）：
   - 问答列表（手风琴展开）
   - 集成 FAQSchema（🤖自动生成）
   - 分类筛选

3. 博客系统：
   - /blog 列表页：文章卡片、分页、分类筛选
   - /blog/[slug] 详情页：
     - 文章内容
     - 发布日期组件（🤖自动显示）
     - 作者信息组件（🤖自动关联）
     - 摘要/TL;DR 区域（🧠AI 可生成）
     - Article Schema（🤖自动生成）
     - 相关文章推荐

4. /author/[slug] 作者页面：
   - 作者头像、姓名、简介
   - 资质证书展示
   - 社交链接
   - 作者发布的文章列表
   - Person Schema（🤖自动生成）
```

---

### 步骤 2.6：E-E-A-T 信任元素

**提示词：**
```
根据功能文档 2.6，添加 E-E-A-T 信任元素：

1. TrustBadges 组件（frontend/src/components/trust/）：
   - PaymentBadges.astro：安全支付徽章（Stripe/PayPal/Visa/Mastercard）
   - SSLBadge.astro：SSL 安全标识
   - 在 Footer 和结算页展示

2. SocialLinks 组件：
   - Footer 添加社交媒体链接（Instagram/TikTok/Facebook/YouTube）
   - 图标 + 链接

3. MediaMentions 组件：
   - 媒体报道 logo 展示
   - 可链接到报道原文
   - 在首页/关于页展示

4. ProductCertifications 组件：
   - 产品认证标识（CE/FCC/FDA 等）
   - 在产品详情页展示

5. ThirdPartyReviews 组件：
   - Trustpilot/Google Reviews 评分展示
   - 链接到第三方评价页面
```

---

## 第3阶段：后端 API

### 步骤 3.1：域名品牌识别 ✅

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 域名识别 | 🤖 自动 | 根据 Host 头自动识别品牌 |
| 品牌缓存 | 🤖 自动 | KV 自动缓存品牌配置 |
| KV 缓存键包含 Host | 🤖 自动 | KV 缓存 key 必须包含域名（Host），避免多域名缓存污染导致跨品牌串读 |
| 上下文注入 | 🤖 自动 | 所有 API 自动携带 brand_id |

**提示词：**
```
根据功能文档 3.1，实现域名品牌识别：

1. 域名识别中间件（worker/src/middleware/brand.ts）：
   - 从请求 Host 头获取域名
   - 查询 brands.domain 获取 brand_id
   - 将 brand_id 注入请求上下文
   - 所有后续 API 自动携带 brand_id（🤖自动）

2. 品牌信息 KV 缓存：
   - 首次查询后缓存到 Cloudflare KV（🤖自动）
   - KV key 必须包含 Host（例如 brand:domain:{host}）
   - 设置合理的 TTL（如 1 小时）
   - 品牌更新时清除缓存

3. 默认品牌回退：
   - 开发环境（localhost）使用默认品牌
   - 生产环境未匹配域名返回 404/站点未开通页（避免误落到默认品牌）

4. 品牌上下文工具函数：
   - getBrandId(request): 获取当前品牌 ID
   - getBrandConfig(request): 获取品牌完整配置
```

---

### 步骤 3.2：基础 API 完善 ✅

**提示词：**
```
根据功能文档 3.2，完善基础 API：

1. 产品列表 API（POST /api/products/list）：
   - 自动按 brand_id 过滤（🤖自动）
   - 支持分页：page, pageSize
   - 支持筛选：category_id, price_min, price_max
   - 支持排序：price_asc, price_desc, newest, bestseller
   - 返回：products[], total, page, pageSize

2. 产品详情 API（GET /api/products/:slug）：
   - 自动按 brand_id 过滤（🤖自动）
   - 返回完整产品信息 + 分类信息
   - 返回相关产品（🤖算法自动匹配）

3. 分类 API（GET /api/categories）：
   - 自动按 brand_id 过滤（🤖自动）
   - 返回层级结构（parent_id 关联）
   - 包含每个分类的产品数量
```

---

### 步骤 3.3：订单和支付 ✅

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 库存验证 | 🤖 自动 | 下单时自动验证库存 |
| 金额/币种校验 | 🤖 自动 | 订单金额与币种必须以服务端计算为准，禁止信任前端传入 |
| 支付回调 | 🤖 自动 | Webhook 自动更新订单状态 |
| Webhook 幂等与去重 | 🤖 自动 | 保存 stripe_event_id，重复事件不重复处理，支持安全重放 |
| 订单状态机校验 | 🤖 自动 | 仅允许合法状态流转（pending→paid→...），避免异常回退 |
| 订单邮件 | 🤖 自动 | 支付成功自动发送确认邮件 |

**提示词：**
```
根据功能文档 3.3，实现订单和支付：

1. 购物车验证 API（POST /api/cart/validate）：
   - 验证产品是否存在、是否上架
   - 验证库存是否充足（🤖自动）
   - 验证价格是否正确
   - 返回验证结果 + 最新价格

2. 创建订单 API（POST /api/orders/create）：
   - 接收：items[], shipping_address, email
   - 验证购物车（🤖自动）
   - 服务端重新计算金额/币种（不要信任前端价格），并将订单金额写入 orders
   - 创建订单记录（状态：pending）
   - 创建 Stripe PaymentIntent
   - 返回：order_id, client_secret

3. 订单详情 API（GET /api/orders/:id）：
   - 验证订单归属
   - 返回订单完整信息

4. Stripe Webhook（POST /api/stripe/webhook）：
   - 验证 Stripe 签名
   - 幂等处理：保存 stripe_event_id，重复事件直接忽略
   - 状态机校验：仅允许 pending→paid / pending→failed 等合法流转
   - 处理 payment_intent.succeeded：
     - 更新订单状态为 paid（🤖自动）
     - 扣减库存（🤖自动）
     - 发送订单确认邮件（🤖自动，使用 Resend）
   - 处理 payment_intent.payment_failed：
     - 更新订单状态为 failed

5. 邮件通知（worker/src/utils/email.ts）：
   - 使用 Resend API
   - 订单确认邮件模板
   - 发货通知邮件模板
```

---

### 步骤 3.4：AI 客服

> **多品牌设计**：每个品牌独立的知识库、Prompt、配置，通过 `brand_id` 隔离

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 对话回复 | 🧠 AI | AI 基于品牌知识库自动回复 |
| 知识检索 | 🧠 AI | RAG 按 brand_id 检索相关知识 |
| 品牌级配置 | ⚙️ 配置 | 每品牌独立 Prompt/人设/欢迎语 |
| 语言检测 | 🧠 AI | AI 自动检测用户语言并回复 |
| 意图识别 | 🧠 AI | AI 识别用户意图 |
| 人工转接 | ⚙️ 配置 | 复杂问题按配置规则转人工 |

**提示词：**
```
根据功能文档 3.4，实现多品牌 AI 客服：

1. 品牌级配置读取：
   - 从 settings 表读取品牌 AI 配置（ai_enabled, ai_system_prompt, ai_persona 等）
   - 配置缺失时使用默认值
   - 品牌名称/信息注入到 System Prompt

2. 普通对话 API（POST /api/chat）：
   - 接收：message, sessionId（可选）
   - 读取品牌配置构建 System Prompt
   - 调用 pgvector 检索品牌知识库（按 brand_id 过滤）
   - 获取最近 N 条对话历史作为上下文
   - 调用 DeepSeek API 生成回复
   - 保存对话到 conversations 表
   - 返回：reply, sessionId

3. 流式响应 API（POST /api/chat/stream）：
   - 使用 Server-Sent Events
   - 实时流式输出 AI 回复
   - 同样支持 RAG + 对话历史

4. 知识库管理（Supabase pgvector）：
   - knowledge_base 表添加 embedding 列（vector(1536)）
   - POST /api/knowledge：添加知识条目，调用 DeepSeek embedding
   - GET /api/knowledge：获取品牌知识列表
   - DELETE /api/knowledge/:id：删除知识
   - 向量检索函数：match_knowledge(query_embedding, brand_id, limit)

5. 意图识别与人工转接：
   - AI 识别意图：咨询、投诉、退换货、物流查询
   - 匹配 ai_handoff_keywords 时标记 needs_human = true
   - 返回转接提示
```

---

## 第4阶段：管理后台

### 步骤 4.1：后台框架

**提示词：**
```
根据功能文档 4.1，搭建管理后台框架：

1. 后台路由和布局（frontend/src/pages/admin/）：
   - AdminLayout.astro：侧边栏 + 顶栏 + 内容区
   - 侧边栏导航：仪表盘、产品、订单、客户、内容、设置

2. Supabase Auth 登录：
   - /admin/login 登录页
   - 邮箱 + 密码登录
   - 登录状态检查中间件
   - 登出功能

3. 仪表盘（/admin）：
   - 统计卡片：今日销售额、订单数、访客数、转化率
   - 销售趋势图（近 7 天/30 天）
   - 最近订单列表
   - 待处理事项提醒

4. 通用组件（frontend/src/components/admin/）：
   - DataTable.astro：数据表格（排序、筛选、分页）
   - Modal.astro：模态框
   - Toast.astro：消息提示
   - Form 组件：Input、Select、Textarea、Switch

5. 品牌切换器：
   - 顶栏显示当前品牌
   - 下拉切换品牌（超级管理员可见）
   - 切换后刷新数据

6. 角色权限模型（RBAC）：
   - 定义 super_admin / brand_admin / editor / read_only 权限边界
   - 后台 UI 与 API 权限校验保持一致
   - 与 Supabase RLS 策略对齐，避免仅前端隐藏导致越权
```

---

### 步骤 4.2：产品管理

**提示词：**
```
根据功能文档 4.2，实现产品管理：

1. 产品列表页（/admin/products）：
   - DataTable 展示：图片、名称、价格、库存、状态
   - 筛选：分类、状态（上架/下架）
   - 搜索：名称、SKU
   - 分页
   - 批量操作：上架、下架、删除

2. 产品编辑页（/admin/products/[id]）：
   - 基本信息：名称、Slug、描述（富文本）
   - 价格：原价、促销价
   - 库存：数量、SKU
   - 图片上传：主图 + 多图
   - 分类选择（多选）
   - SEO 字段：Meta Title、Meta Description
   - 规格参数：动态添加 key-value
   - 状态：上架/下架

3. 产品创建页（/admin/products/new）：
   - 复用编辑页组件

4. 分类管理（/admin/categories）：
   - 树形结构展示
   - 拖拽排序
   - CRUD 操作
   - 父分类选择
```

---

### 步骤 4.3：订单管理

**提示词：**
```
根据功能文档 4.3，实现订单管理：

1. 订单列表页（/admin/orders）：
   - DataTable 展示：订单号、客户、金额、状态、时间
   - 状态筛选：pending、paid、shipped、delivered、cancelled
   - 时间范围筛选
   - 搜索：订单号、客户邮箱

2. 订单详情页（/admin/orders/[id]）：
   - 订单信息：订单号、创建时间、状态
   - 客户信息：姓名、邮箱、电话
   - 收货地址
   - 商品清单：图片、名称、数量、单价、小计
   - 金额明细：小计、运费、折扣、总计
   - 支付信息：支付方式、支付时间、交易号

3. 状态更新：
   - 状态流转：pending → paid → shipped → delivered
   - 状态变更记录时间线

4. 物流信息填写：
   - 快递公司选择
   - 快递单号输入
   - 物流链接
   - 填写后自动发送发货通知邮件（🤖自动）

5. 退款操作：
   - 调用 Stripe Refund API
   - 记录退款原因
   - 更新订单状态
```

---

### 步骤 4.4：系统设置

**提示词：**
```
根据功能文档 4.4，实现系统设置：

1. 店铺设置（/admin/settings/store）：
   - 店铺名称
   - Logo 上传
   - 联系邮箱、电话、地址
   - 社交媒体链接

2. 支付设置（/admin/settings/payment）：
   - Stripe 公钥/私钥配置
   - 支持的支付方式开关
   - 货币设置

3. 发货设置（/admin/settings/shipping）：
   - 运费规则：固定运费 / 满额包邮 / 按重量
   - 发货时间说明
   - 支持的国家/地区

4. 邮件模板（/admin/settings/email）：
   - 订单确认邮件模板
   - 发货通知邮件模板
   - 支持变量插入：{{order_id}}、{{customer_name}} 等
   - 预览功能

5. AI 客服设置（/admin/settings/ai）：
   - AI 客服开关
   - 欢迎语配置
   - 知识库管理入口
   - 人工转接规则配置
```

---

### 步骤 4.5：E-E-A-T 内容管理

**提示词：**
```
根据功能文档 4.5，实现 E-E-A-T 内容管理：

1. 作者管理（/admin/authors）：
   - 作者列表：头像、姓名、文章数
   - 作者创建/编辑：
     - 姓名、头像上传
     - 简介（富文本）
     - 资质证书（图片上传）
     - 社交链接
   - 查看作者发布的文章

2. 评价管理（/admin/reviews）：
   - 评价列表：产品、评分、内容、状态、时间
   - 状态筛选：待审核、已通过、已拒绝
   - 审核操作：通过、拒绝、标记垃圾
   - 购买者标识（🤖自动标记已购买用户）
   - 商家回复功能
   - 邀请评价：订单完成后自动发送邮件邀请（🤖自动）

3. 信任元素管理（/admin/trust）：
   - 媒体报道：上传 logo、报道链接、截图
   - 产品认证：上传 CE/FCC/FDA 等认证图片
   - 第三方评价：配置 Trustpilot/Google Reviews 链接
   - 社交媒体：配置官方账号链接
```

---

## 第5阶段：AI 内容工具

### 步骤 5.1：AI 内容质量防护

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 审核流程 | ⚙️ 流程 | AI 生成 → 草稿 → 审核 → 发布 |
| 原创度检测 | 🧠 AI | AI 自动检测相似度 |
| AI 内容标识 | 🤖 自动 | 系统自动标记 AI 生成内容 |
| 内容差异化 | 🧠 AI | AI 自动融入真实产品数据 |
| 发布频率限制 | 🤖 自动 | 系统自动限制发布数量 |
| 更新提醒 | 🤖 自动 | 定时检测过期内容 |

**提示词：**
```
根据功能文档 5.1，实现 AI 内容质量防护：

1. 内容状态流程：
   - 状态字段：draft（草稿）、pending_review（待审核）、published（已发布）
   - AI 生成内容默认为 draft 状态
   - 禁止从 draft 直接到 published（必须经过审核）

2. 原创度检测（🧠AI）：
   - 调用 AI 对比已有内容相似度
   - 相似度 > 30% 显示警告
   - 相似度 > 50% 禁止发布
   - 显示相似内容来源

3. AI 内容标识（🤖自动）：
   - 数据库字段：is_ai_generated, ai_generated_at
   - AI 生成时自动标记
   - 后台可筛选 AI 生成的内容

4. 内容差异化引擎（🧠AI）：
   - AI 生成时自动融入：
     - 真实产品规格参数
     - 真实使用场景
     - 真实客户评价摘要
   - 避免同质化内容

5. 作者署名系统：
   - AI 内容必须关联真实作者
   - 作者信息自动显示在内容页

6. 发布频率限制（🤖自动）：
   - 配置：每日/每周最大发布数量
   - 超出限制时禁止发布
   - 后台显示剩余配额

7. 内容更新提醒（🤖自动）：
   - 定时任务检测 > 90 天未更新的内容
   - 发送提醒邮件/后台通知
   - 后台显示需更新内容列表
```

---

### 步骤 5.2：视频脚本生成

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 脚本生成 | 🧠 AI | AI 生成 Hook + 主体 + CTA |
| 配乐推荐 | 🧠 AI | AI 根据风格推荐 |
| Hashtag 推荐 | 🧠 AI | AI 分析内容生成标签 |
| 批量生成 | 🧠 AI | AI 批量生成多产品脚本 |
| 变体生成 | 🧠 AI | AI 生成不同风格变体 |

**提示词：**
```
根据功能文档 5.2，实现视频脚本生成：

1. 脚本生成页面（/admin/content/scripts/new）：
   - 产品选择（下拉/搜索）
   - 视频类型选择：开箱、测评、教程、促销
   - 视频时长选择：15秒、30秒、60秒
   - 语气风格选择：专业、活泼、奢华

2. AI 脚本生成（🧠AI）：
   - 调用 DeepSeek API
   - 生成结构：
     - Hook（前3秒吸引注意）
     - 主体（产品展示/功能介绍）
     - CTA（引导行动）
   - 自动融入产品真实数据（🧠AI 内容差异化）

3. 配乐推荐（🧠AI）：
   - 根据视频类型和风格推荐 TikTok 热门音乐
   - 显示音乐名称、时长、链接

4. Hashtag 推荐（🧠AI）：
   - AI 分析脚本内容生成相关标签
   - 推荐 5-10 个标签
   - 显示标签热度（如有数据）

5. 批量生成：
   - 选择多个产品
   - 批量生成脚本（受发布频率限制）
   - 队列处理，显示进度

6. 脚本变体生成（🧠AI）：
   - 为同一产品生成 3-5 个不同风格变体
   - 方便 A/B 测试

7. 脚本库（/admin/content/scripts）：
   - 脚本列表：产品、类型、创建时间、状态
   - 编辑、复制、删除
   - 导出为文本
```

---

### 步骤 5.3：文案生成

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 产品描述 | 🧠 AI | AI 生成长/短描述 |
| 社交文案 | 🧠 AI | AI 生成平台适配文案 |
| 邮件文案 | 🧠 AI | AI 生成营销邮件 |
| 多语言翻译 | 🧠 AI | AI 翻译保持语义 |
| A/B 变体 | 🧠 AI | AI 生成多个变体 |
| 语气调整 | 🧠 AI | AI 根据品牌调性调整 |

**提示词：**
```
根据功能文档 5.3，实现文案生成：

1. 产品描述生成（/admin/content/copy/product）：
   - 选择产品
   - 生成类型：长描述（详情页）、短描述（列表页）
   - AI 自动融入真实规格参数（🧠AI）
   - 生成后可编辑、保存到产品

2. 社交媒体文案（/admin/content/copy/social）：
   - 选择产品或主题
   - 平台选择：Instagram、Facebook、TikTok、Twitter
   - AI 生成平台适配文案（🧠AI）：
     - Instagram：图片描述 + Hashtag
     - TikTok：短视频文案
     - Facebook：长文案 + CTA
   - 字符计数（各平台限制不同）

3. 邮件营销文案（/admin/content/copy/email）：
   - 邮件类型：促销、弃购挽回、新品通知、节日营销
   - AI 生成邮件主题 + 正文（🧠AI）
   - 支持变量插入
   - 预览效果

4. 多语言翻译（🧠AI）：
   - 选择源语言和目标语言
   - AI 翻译保持语义（非直译）
   - 保留 SEO 关键词
   - 支持批量翻译

5. A/B 文案变体（🧠AI）：
   - 为同一内容生成 2-3 个变体
   - 不同角度/语气/CTA
   - 方便 A/B 测试

6. 语气风格调整（🧠AI）：
   - 品牌调性选择：专业、活泼、奢华、亲切
   - AI 根据调性调整文案风格

7. 文案库（/admin/content/copy）：
   - 分类管理：产品描述、社交文案、邮件文案
   - 搜索、筛选、复用
```

---

## 第6阶段：数据分析

### 步骤 6.1：数据看板

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 数据统计 | 🤖 自动 | 定时聚合计算 |
| 趋势图表 | 🤖 自动 | 自动生成图表 |
| 排行榜 | 🤖 自动 | 自动计算排名 |
| 转化漏斗 | 🤖 自动 | 自动计算各环节转化率 |

**提示词：**
```
根据功能文档 6.1，实现数据看板：

1. 销售概览（/admin/analytics）：
   - 统计卡片（🤖自动计算）：
     - 今日/本周/本月销售额
     - 今日/本周/本月订单数
     - 平均客单价
     - 转化率
   - 同比/环比变化百分比

2. 销售趋势图（🤖自动）：
   - 使用 Chart.js
   - 时间范围：7天、30天、90天、自定义
   - 指标切换：销售额、订单数、访客数
   - 按天/周/月聚合

3. 产品排行榜（🤖自动）：
   - 销量 Top 10
   - 收入 Top 10
   - 支持时间范围筛选

4. 客户分析（🤖自动）：
   - 新客/老客比例饼图
   - 复购率
   - 客户地域分布

5. 利润分析（🤖自动）：
   - 毛利 = 销售额 - 成本
   - 净利 = 毛利 - 运费 - 手续费
   - 利润率趋势图

6. 流量来源（🤖自动）：
   - 直接访问、搜索引擎、社交媒体、广告
   - 各来源占比饼图
   - 各来源转化率对比

7. 转化漏斗（🤖自动）：
   - 访问 → 浏览产品 → 加购 → 结算 → 支付
   - 各环节人数和转化率
   - 漏斗可视化图表
```

---

## 第7阶段：高级 SEO/GEO 工具

### 步骤 7.1：页面级 SEO 优化

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 关键词密度 | 🤖 自动 | 自动分析计算 |
| 重复 Meta 检测 | 🤖 自动 | 自动扫描全站 |
| 批量 Meta 生成 | 🧠 AI | AI 批量生成 |
| Alt 文本建议 | 🧠 AI | AI 分析图片生成描述 |
| 分享图片生成 | 🧠 AI | AI 自动生成分享图 |
| 内链 AI 建议 | 🧠 AI | AI 分析相关性推荐 |
| 图片压缩 | 🤖 自动 | 上传时自动压缩 |
| WebP 转换 | 🤖 自动 | 上传时自动转换 |

**提示词：**
```
根据功能文档 7.1，实现页面级 SEO 优化：

1. Meta 标签管理（/admin/seo/meta）：
   - Title 编辑器：
     - 变量模板支持：{产品名}、{分类}、{品牌}
     - 实时字符计数（推荐 50-60）
   - Description 编辑器：
     - 实时 Google 搜索结果预览
     - 字符计数（推荐 150-160）
   - 关键词密度分析（🤖自动）：
     - 分析关键词在标题/描述/正文的出现频率
     - 建议 1-3%
   - 重复 Meta 检测（🤖自动）：
     - 扫描全站标记重复页面
   - 批量 Meta 生成（🧠AI）：
     - 选择多个产品
     - AI 批量生成 title/description

2. 图片 SEO（/admin/seo/images）：
   - Alt 文本检查（🤖自动）：
     - 扫描缺失 alt 的图片
     - 列表展示
   - Alt 文本 AI 建议（🧠AI）：
     - AI 分析图片内容
     - 自动建议描述文本
     - 一键应用
   - 文件名优化（🧠AI）：
     - 检测无意义文件名（IMG_001.jpg）
     - AI 建议语义化命名
   - 图片压缩（🤖自动）：
     - 上传时自动压缩 > 200KB 图片
   - WebP 转换（🤖自动）：
     - 上传时自动生成 WebP 格式

3. 社交分享优化（/admin/seo/social）：
   - Open Graph 编辑器
   - 分享预览模拟器（🤖自动）：
     - Facebook/Twitter/LinkedIn/微信 预览
   - 分享图片生成（🧠AI）：
     - AI 自动生成 1200x630 分享图
     - 包含产品图、标题、品牌 logo

4. 内链优化（/admin/seo/links）：
   - 孤立页面检测（🤖自动）
   - 内链密度分析（🤖自动）
   - 相关内容 AI 推荐（🧠AI）：
     - AI 分析内容相关性
     - 自动生成内链建议
   - 内链结构可视化（🤖自动）
```

---

### 步骤 7.2：技术 SEO

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| Sitemap 更新 | 🤖 自动 | 内容变更自动更新 |
| 404 监控 | 🤖 自动 | 自动记录 404 请求 |
| Core Web Vitals | 🤖 自动 | 自动采集性能数据 |
| SSL 监控 | 🤖 自动 | 定时检测证书到期 |

**提示词：**
```
根据功能文档 7.2，实现技术 SEO：

1. Sitemap 管理（/admin/seo/sitemap）：
   - 查看当前 sitemap 内容
   - 手动刷新按钮
   - 自动更新（🤖内容变更时自动）
   - Sitemap 分片（> 50,000 URL 自动分片）
   - 一键提交到 Google Search Console

2. Robots.txt 编辑器（/admin/seo/robots）：
   - 可视化编辑
   - 语法高亮
   - 规则测试：输入 URL 测试 Allow/Disallow

3. URL 与重定向（/admin/seo/redirects）：
   - 301 重定向管理
   - 批量导入/导出
   - 支持正则匹配
   - 重定向链检测（🤖自动）
   - 404 页面监控（🤖自动记录）：
     - 实时记录 404 请求
     - 自动建议重定向目标

4. Core Web Vitals 监控（/admin/seo/performance）：
   - LCP、FID、CLS、INP 指标（🤖自动采集）
   - 性能趋势图
   - 优化建议生成

5. 移动端 SEO：
   - 移动友好测试
   - 视口配置检查
   - 触控目标检查

6. 安全检查：
   - HTTPS 混合内容检测
   - SSL 证书监控（🤖定时检测，到期前 30 天提醒）
```

---

### 步骤 7.3：内容 SEO

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 关键词扩展 | 🧠 AI | AI 生成长尾词 |
| 搜索意图分类 | 🧠 AI | AI 自动分类 |
| 内容评分 | 🧠 AI | AI 综合评分 |
| 博客文章生成 | 🧠 AI | AI 生成 SEO 文章 |
| 文章大纲生成 | 🧠 AI | AI 生成结构大纲 |
| FAQ 生成 | 🧠 AI | AI 基于客服记录生成 |
| E-E-A-T 评分 | 🧠 AI | AI 评估内容质量 |

**提示词：**
```
根据功能文档 7.3，实现内容 SEO：

1. 关键词研究（/admin/seo/keywords）：
   - 种子词扩展（🧠AI）：
     - 输入核心词
     - AI 生成 50+ 相关长尾词
   - 搜索意图分类（🧠AI）：
     - 信息型、导航型、交易型、商业调查型
   - 关键词难度评估（🧠AI）
   - 关键词分组（🧠AI）

2. 内容优化（/admin/seo/content）：
   - 内容评分系统（🧠AI）：
     - 关键词使用、可读性、长度、结构
     - 0-100 分
   - 可读性分析（🤖自动）
   - 标题层级检查（🤖自动）
   - 内容长度建议（🧠AI）

3. AI 内容生成（遵循质量防护）：
   - 博客文章生成（🧠AI）：
     - 输入关键词
     - AI 生成 1500-3000 字 SEO 文章
     - 必须人工审核后发布
   - 文章大纲生成（🧠AI）：
     - AI 生成结构大纲
     - 支持手动调整
   - 产品描述优化（🧠AI）：
     - AI 重写产品描述
     - 自动融入真实规格参数
   - FAQ 生成（🧠AI）：
     - 优先基于真实客服记录
     - AI 补充常见问题

4. E-E-A-T 评分（🧠AI）：
   - AI 评估内容的：
     - Experience（经验）
     - Expertise（专业）
     - Authoritativeness（权威）
     - Trustworthiness（可信）
   - 低分内容标记需优化
```

---

### 步骤 7.4：监控与报告

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 排名监控 | 🤖 自动 | 定时追踪排名 |
| 排名变化提醒 | 🤖 自动 | 变化超阈值自动通知 |
| 索引监控 | 🤖 自动 | 定时检测索引状态 |
| 周报/月报 | 🤖 自动 | 定时自动生成 |

**提示词：**
```
根据功能文档 7.4，实现监控与报告：

1. 排名追踪（/admin/seo/rankings）：
   - 关键词排名监控（🤖定时追踪）
   - 排名变化提醒（🤖自动）：
     - 上升/下降超过 5 位时邮件提醒
   - 竞品排名对比
   - 历史排名图表

2. 索引监控（/admin/seo/index）：
   - 索引状态检查（🤖定时检测）
   - 索引覆盖率报告
   - 索引请求提交
   - 索引异常提醒（🤖自动）
   - Search Console 集成

3. SEO 健康评分（/admin/seo/health）：
   - 综合健康评分 0-100（🤖自动计算）
   - 问题优先级排序：严重/警告/建议
   - 修复进度追踪

4. 自动化报告：
   - 周报自动生成（🤖每周一自动）
   - 月报自动生成（🤖每月 1 日自动）
   - 邮件发送
   - PDF/Excel 导出
   - 多品牌汇总报告
```

---

### 步骤 7.5：GEO 生成式引擎优化

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| AI 爬虫识别 | 🤖 自动 | 自动识别 AI 爬虫 |
| AI 爬虫日志 | 🤖 自动 | 自动记录访问 |
| 摘要生成 | 🧠 AI | AI 自动生成摘要 |
| 定义式开头 | 🧠 AI | AI 自动生成定义 |
| 品牌提及优化 | 🧠 AI | AI 优化品牌出现 |
| AI 引用追踪 | 🤖 自动 | 定时监控 AI 引用 |
| 问题库建设 | 🧠 AI | AI 收集用户问题 |
| 长尾问题内容 | 🧠 AI | AI 生成问答内容 |

**提示词：**
```
根据功能文档 7.5，实现 GEO 优化：

1. AI 爬虫管理（/admin/geo/crawlers）：
   - AI 爬虫识别（🤖自动）：
     - GPTBot、ClaudeBot、PerplexityBot、Google-Extended
   - robots.txt AI 规则配置
   - AI 爬虫日志（🤖自动记录）：
     - 访问频率、抓取页面

2. 内容结构优化（/admin/geo/structure）：
   - 问答格式检测（🤖自动）
   - 列表/表格使用率分析（🤖自动）
   - 段落长度优化建议（🧠AI）
   - 摘要/TL;DR 生成（🧠AI）：
     - 为长文自动生成摘要
   - 定义式开头检测（🧠AI）：
     - 检测是否以"X 是..."开头
     - 自动建议优化

3. 引用与可信度（/admin/geo/credibility）：
   - 数据来源标注提示（🧠AI）
   - 外部引用检测（🤖自动）
   - 专家引言建议（🧠AI）

4. 品牌可见性（/admin/geo/brand）：
   - 品牌名提及优化（🧠AI）：
     - 确保品牌名自然出现 2-3 次
   - 品牌+产品关联（🧠AI）
   - 独特卖点强调（🧠AI）
   - 对比内容创建（🧠AI）：
     - 生成"X vs Y"对比内容

5. AI 搜索监控（/admin/geo/monitoring）：
   - AI 引用追踪（🤖定时监控）：
     - 监控品牌是否被 ChatGPT、Perplexity 引用
   - AI 回答截图（🤖定期自动）
   - 竞品 AI 可见性对比（🤖自动）
   - AI 流量来源分析（🤖自动）

6. GEO 内容策略（/admin/geo/content）：
   - 问题库建设（🧠AI）：
     - AI 收集用户可能问 AI 的问题
   - 长尾问题覆盖（🧠AI）：
     - AI 生成"如何选择..."等内容
   - 产品使用指南（🧠AI）
   - 行业知识内容（🧠AI）
   - 本地化内容（🧠AI）
```

---

## 第8阶段：多品牌管理

### 步骤 8.1：品牌管理

**提示词：**
```
根据功能文档 8.1，实现品牌管理：

1. 品牌列表（/admin/brands）：
   - 品牌卡片：Logo、名称、域名、状态
   - 创建新品牌按钮

2. 品牌创建/编辑（/admin/brands/[id]）：
   - 基本信息：名称、Slug、描述
   - 域名绑定：
     - 输入域名
     - DNS 配置指引
     - 域名验证状态
   - 品牌主题定制：
     - 主色调
     - 字体选择
     - Logo 上传
   - 状态：启用/禁用

3. 用户权限分配：
   - 品牌管理员：完全管理权限
   - 编辑：内容编辑权限
   - 只读：仅查看权限
```

---

### 步骤 8.2：协作管理

**提示词：**
```
根据功能文档 8.2，实现协作管理：

1. 超级管理员总后台：
   - 品牌切换器（顶栏）
   - 所有品牌数据汇总
   - 用户管理

2. 品牌独立后台：
   - 品牌管理员只能看到自己的品牌
   - 数据隔离

3. 跨品牌数据看板（/admin/analytics/all）：
   - 所有品牌销售额汇总
   - 品牌对比图表
   - 各品牌排名

4. 知识库共享：
   - 通用知识库（跨品牌）
   - 品牌专属知识库
   - 共享/专属切换

5. 模板共享：
   - 邮件模板跨品牌复用
   - 脚本模板跨品牌复用
```

---

## 第9阶段：流量与转化

### 步骤 9.1：广告追踪像素

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 像素埋点 | 🤖 自动 | 代码自动触发事件 |
| 服务端事件 | 🤖 自动 | 服务端自动发送 |
| 统一事件追踪层 | 🤖 自动 | 统一 `track(event, payload)`，再映射各平台像素与 CAPI，降低多平台维护成本 |
| 事件去重与一致性校验 | 🤖 自动 | 为关键事件生成 event_id，并保证前端像素与服务端事件可对齐（订单号/金额/货币一致） |

**提示词：**
```
根据功能文档 9.1，实现广告追踪像素：

1. 像素配置界面（/admin/settings/pixels）：
   - Facebook Pixel ID
   - Google Ads Conversion ID
   - TikTok Pixel ID
   - Pinterest Tag ID
   - 各平台开关

2. 前端埋点（🤖自动触发）：
   - PageView：页面加载
   - ViewContent：产品详情页
   - AddToCart：加入购物车
   - InitiateCheckout：进入结算页
   - Purchase：支付成功

2.1 统一事件追踪层：
   - 实现 track(eventName, payload) 并在页面/组件调用
   - 将 track 的事件映射到 Facebook/Google/TikTok/Pinterest 对应事件

2.2 事件去重：
   - 关键事件生成 event_id
   - 前端像素与服务端 CAPI 使用同一 event_id（如平台支持）

3. 像素脚本注入：
   - 根据配置动态注入各平台脚本
   - 事件自动触发

4. 服务端事件（Conversions API）（🤖自动）：
   - Facebook Conversions API
   - 绕过浏览器拦截
   - 提高追踪准确率
```

---

### 步骤 9.2：UTM 参数追踪

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| UTM 解析 | 🤖 自动 | 自动解析存储 |
| 来源归因 | 🤖 自动 | 订单自动关联来源 |
| 来源报表 | 🤖 自动 | 自动统计各渠道数据 |
| 归因窗口与 TTL 策略 | 🤖 自动 | 明确 first_touch/last_touch 保存窗口与 TTL，并在创建订单时落库 |

**提示词：**
```
根据功能文档 9.2，实现 UTM 追踪：

1. UTM 参数解析（🤖自动）：
   - 自动解析 URL 中的：
     - utm_source（来源）
     - utm_medium（媒介）
     - utm_campaign（活动）
     - utm_content（内容）
     - utm_term（关键词）
   - 存储到 Cookie/Session
   - 记录 first_touch 与 last_touch（首次存在则不覆盖 first_touch，仅更新 last_touch）
   - 设置 TTL（示例：first_touch 90 天，last_touch 30 天）

2. 来源归因存储（🤖自动）：
   - 订单创建时自动关联 UTM 参数
   - 支持首次触达归因
   - 支持末次触达归因

3. 来源报表（/admin/analytics/sources）：
   - 按来源统计：订单数、销售额、转化率
   - 各渠道 ROI 对比
   - 时间范围筛选
```

---

### 步骤 9.3：邮件营销自动化

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 交易邮件 | 🤖 自动 | 事件触发自动发送 |
| 弃购检测 | 🤖 自动 | 自动检测标记 |
| 弃购邮件序列 | 🤖 自动 | 定时自动发送 |
| 弃购邮件内容 | 🧠 AI | AI 生成个性化内容 |
| 欢迎邮件 | 🤖 自动 | 订阅后自动发送 |
| 欢迎邮件内容 | 🧠 AI | AI 生成内容 |
| 节日邮件 | 🧠 AI | AI 生成促销内容 |
| 发送时间优化 | 🧠 AI | AI 选择最佳时间 |
| 退订管理 | 🤖 自动 | 自动处理退订 |
| 订阅偏好与营销授权 | 🤖 自动 | 区分交易邮件与营销邮件；记录 opt-in/opt-out 并确保退订后仅停止营销邮件 |
| 弃购判定防误伤 | 🤖 自动 | 弃购检测需排除已下单/已支付用户；支付失败建议使用独立触达策略 |

**提示词：**
```
根据功能文档 9.3，实现邮件营销：

1. 交易邮件（🤖自动发送）：
   - 订单确认邮件：支付成功后自动发送
   - 发货通知邮件：填写物流单号后自动发送
   - 送达确认邮件：物流签收后自动发送

2. 弃购挽回（/admin/marketing/abandoned）：
   - 弃购检测（🤖自动）：
     - 用户填写邮箱但未完成支付
     - 自动标记为弃购
     - 排除已下单/已支付用户（防误伤）
   - 弃购邮件序列（🤖自动发送）：
     - #1：1 小时后，提醒购物车商品
     - #2：24 小时后，强调库存紧张
     - #3：72 小时后，提供折扣码
   - 弃购邮件内容（🧠AI）：
     - AI 生成个性化挽回内容
   - 弃购转化统计（🤖自动）

3. 营销邮件（/admin/marketing/campaigns）：
   - 欢迎邮件序列（🤖自动）：
     - 新订阅用户自动发送 3 封
   - 欢迎邮件内容（🧠AI）：
     - AI 生成品牌故事/热销/首单优惠
   - 复购提醒（🤖自动）：
     - 购买 30/60/90 天后自动提醒
   - 节日营销（🧠AI）：
     - AI 生成黑五/圣诞/新年促销邮件
   - 新品通知（🤖自动）：
     - 新品上架自动通知订阅用户

4. 邮件模板编辑器（/admin/marketing/templates）：
   - 可视化编辑
   - 变量插入：{{customer_name}}、{{order_id}} 等
   - 预览功能

5. 发送时间优化（🧠AI）：
   - AI 根据用户时区和行为选择最佳发送时间

6. 邮件合规：
   - 退订链接（🤖自动包含）
   - 退订管理（🤖自动处理）
   - 发送频率限制（🤖自动限制）
   - 区分交易邮件与营销邮件（退订后仍允许发送订单确认/发货等交易邮件）
```

---

### 步骤 9.4：优惠券系统

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 优惠码生成 | 🤖 自动 | 系统自动生成随机码 |
| 优惠码验证 | 🤖 自动 | 结算时自动验证 |
| 使用统计 | 🤖 自动 | 自动统计使用数据 |

**提示词：**
```
根据功能文档 9.4，实现优惠券系统：

1. 优惠券管理（/admin/marketing/coupons）：
   - 优惠券列表：码、类型、折扣、使用次数、状态
   - 创建优惠券：
     - 类型：固定金额 / 百分比
     - 折扣值
     - 使用条件：最低消费、指定产品/分类、首单专享
     - 有效期：开始/结束时间
     - 使用次数限制：总次数 / 每用户次数
   - 优惠码生成（🤖自动）：
     - 自定义码（WELCOME10）
     - 系统随机生成

2. 优惠码验证（🤖自动）：
   - 结算时输入优惠码
   - 自动验证有效性
   - 显示折扣金额

3. 使用统计（🤖自动）：
   - 使用次数
   - 带来的销售额
   - 转化率
```

---

### 步骤 9.5：用户留存

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 积分累积 | 🤖 自动 | 购物自动得积分 |
| 积分兑换 | 🤖 自动 | 自动抵扣/兑换 |
| 会员升降级 | 🤖 自动 | 根据消费自动调整 |
| 推荐追踪 | 🤖 自动 | 自动追踪推荐来源 |
| 推荐奖励 | 🤖 自动 | 成功后自动发放 |

**提示词：**
```
根据功能文档 9.5，实现用户留存：

1. 积分系统（/admin/loyalty/points）：
   - 积分规则配置：$1 = ? 积分
   - 积分获取（🤖自动）：
     - 购物自动得积分
   - 积分兑换（🤖自动）：
     - 积分抵扣现金
     - 积分兑换优惠券
   - 积分记录查询

2. 会员等级（/admin/loyalty/tiers）：
   - 等级配置：普通/银牌/金牌
   - 升级门槛：累计消费金额
   - 等级权益：折扣比例
   - 自动升降级（🤖自动）

3. 推荐有礼（/admin/loyalty/referral）：
   - 推荐码生成（🤖自动）：
     - 每个用户自动生成专属推荐码/链接
   - 推荐追踪（🤖自动）：
     - 自动追踪推荐来源
   - 推荐奖励（🤖自动）：
     - 推荐成功后自动发放优惠券/积分
   - 被推荐人优惠（🤖自动）：
     - 新用户自动获得首单折扣
   - 推荐统计（🤖自动）：
     - 推荐人数、带来的订单、佣金
```

---

## 第10阶段：部署运维

### 步骤 10.1：部署配置

**提示词：**
```
根据功能文档 10.1，配置部署：

1. Cloudflare Pages 前端部署：
   - 连接 GitHub 仓库
   - 构建命令：npm run build
   - 输出目录：dist
   - 环境变量配置

2. Cloudflare Workers API 部署：
   - wrangler.toml 配置
   - 环境变量（Secrets）
   - KV 命名空间绑定
   - Vectorize 索引绑定

3. 多域名绑定：
   - 自定义域名配置
   - SSL 证书（Cloudflare 自动）
   - DNS 配置指引

4. GitHub Actions CI/CD：
   - 自动构建
   - 自动测试
   - 自动部署到 Cloudflare

5. 环境变量管理：
   - 开发环境（.env.local）
   - 预发环境（.env.staging）
   - 生产环境（Cloudflare Secrets）
```

---

### 步骤 10.2：监控维护

**开发内容及自动化：**
| 功能 | 自动化 | 说明 |
|------|--------|------|
| 日志记录 | 🤖 自动 | 自动记录请求日志 |
| 关键路径结构化日志 | 🤖 自动 | 对订单创建、Stripe Webhook、AI 对话等关键接口记录 request_id、brand_id、order_id 等字段 |
| 性能监控 | 🤖 自动 | 自动采集性能数据 |
| 备份 | 🤖 自动 | 定时自动备份 |
| 告警 | 🤖 自动 | 超阈值自动通知 |

**提示词：**
```
根据功能文档 10.2，配置监控维护：

1. 日志查看：
   - Cloudflare Workers 日志（🤖自动记录）
   - 错误日志筛选
   - 请求追踪

2. 性能监控（🤖自动采集）：
   - 请求延迟
   - 错误率
   - 请求量

3. 备份策略：
   - Supabase 数据库定期备份（🤖自动）
   - 备份保留策略

4. 安全检查：
   - 依赖漏洞扫描
   - 密钥轮换提醒

5. 告警配置（🤖自动通知）：
   - 错误率超阈值
   - 延迟超阈值
   - 邮件/Slack 通知
   - 覆盖关键链路：订单创建失败、Stripe Webhook 失败/超时
```

---

## 使用说明

1. 按步骤顺序开发，每个步骤完成后更新状态
2. 复制对应步骤的「提示词」发给 AI 进行开发
3. 开发完成后同步更新「功能文档」中的状态
4. 遇到问题可以拆分成更小的子任务

---

## 自动化功能汇总

### 🤖 代码自动执行（无需人工）
- sitemap.xml 动态生成
- Schema 结构化数据生成
- 广告像素埋点
- UTM 参数解析
- 订单/发货邮件发送
- 弃购检测和邮件序列
- 积分累积/兑换
- 会员等级升降
- 推荐追踪和奖励发放
- 数据统计和报表
- AI 爬虫日志
- 图片压缩/WebP 转换

### 🧠 AI 辅助生成（需人工审核）
- 视频脚本生成
- 产品描述生成
- 社交媒体文案
- 邮件营销文案
- 多语言翻译
- 博客文章生成
- FAQ 生成
- 关键词扩展
- 摘要/TL;DR 生成
- Alt 文本建议
- 内链建议
- E-E-A-T 评分
- AI 客服回复

---

## 当前进度

**已完成：** 第1阶段（项目初始化）

**下一步：** 步骤 2.1 - 基础 SEO/GEO 补充
